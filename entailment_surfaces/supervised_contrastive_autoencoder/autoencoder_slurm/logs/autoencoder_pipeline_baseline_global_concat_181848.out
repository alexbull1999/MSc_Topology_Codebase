Starting Surface Distance Metric Analysis job...
Job ID: 181848
Node: gpuvm17
Time: Sat 12 Jul 12:08:15 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Sat Jul 12 12:08:17 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla T4                       Off |   00000000:00:06.0 Off |                    0 |
| N/A   34C    P8             13W /   70W |       0MiB /  15360MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: Tesla T4
GPU memory: 15.6 GB
PyTorch setup verified!

Starting AutoEncoder Pipeline...

GLOBAL DATASET CONTRASTIVE AUTOENCODER PIPELINE
============================================================
Start time: 2025-07-12 12:08:43.390771
Using device: cuda

Configuration:
  Embedding type: concat
  Batch size: 1020
  Global update frequency: 3 epochs
  Training epochs: 20
Experiment setup completed:
  Experiment directory: experiments/global_concat_test_20250712_120843
  Config saved to: experiments/global_concat_test_20250712_120843/config.json
Loading data...
========================================
FlexibleEmbedder initialized with type: 'concat'
Output dimension will be: 1536
GlobalDataLoader initialized:
  Embedding type: concat
  Output dimension: 1536
  Sample size: All
Starting data loading pipeline...
============================================================
Loading training data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 training samples
Loading validation data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 validation samples
Loading test data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 test samples
Generating embeddings for training...
Generating concat embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated concat embeddings: torch.Size([549367, 1536])
Generating embeddings for validation...
Generating concat embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated concat embeddings: torch.Size([549367, 1536])
Generating embeddings for test...
Generating concat embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated concat embeddings: torch.Size([549367, 1536])
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 1536])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 1536])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 1536])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}

Data loading pipeline completed!
Output embedding dimension: 1536
Updated model input_dim to: 1536
BalancedBatchSampler initialized:
  Classes: [2, 0, 1]
  Samples per class per batch: 340
  Effective batch size: 1020
  Number of batches: 537
  Class 2: 183187 samples
  Class 0: 183416 samples
  Class 1: 182764 samples
BalancedBatchSampler initialized:
  Classes: [2, 0, 1]
  Samples per class per batch: 340
  Effective batch size: 1020
  Number of batches: 537
  Class 2: 183187 samples
  Class 0: 183416 samples
  Class 1: 182764 samples
DataLoaders created:
  Batch size: 1020
  Balanced sampling: True
  Train batches: 537
  Val batches: 537
  Test batches: 539
Data loading completed!
  Train: 549367 samples, 537 batches
  Val: 549367 samples, 537 batches
  Test: 549367 samples, 539 batches
Creating model and trainer...
========================================
ContrastiveAutoencoder initialized:
  Input dim: 1536
  Latent dim: 75
  Hidden dims: [512, 256]
  Dropout rate: 0.2
  Total parameters: 1,876,555
Model created with 1,876,555 parameters
FullDatasetContrastiveLoss initialized:
  Margin: 2.0
  Update frequency: 3 epochs
  Max global samples: 5000
FullDatasetCombinedLoss initialized:
  Contrastive weight: 1.0
  Reconstruction weight: 0.0
Optimizer created (lr=0.0001)
GlobalDatasetTrainer initialized on device: cuda
Model parameters: 1,876,555
Starting training...
========================================
Starting Global Dataset Training...
============================================================

üåç Updating global dataset at epoch 1
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.090 ¬± 0.011
    Neg distances: 0.091 ¬± 0.010
    Separation ratio: 1.00x
    Gap: -0.123
    ‚ùå Poor global separation

Epoch 1 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.112, Neg=0.112, Ratio=1.00x, Gap=-0.180
Batch   0/537: Loss=1.9998 (C:1.9998, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.111, Neg=0.112, Ratio=1.00x, Gap=-0.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.111, Neg=0.112, Ratio=1.00x, Gap=-0.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.112, Neg=0.112, Ratio=1.00x, Gap=-0.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.112, Neg=0.112, Ratio=1.00x, Gap=-0.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.113, Neg=0.113, Ratio=1.00x, Gap=-0.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.113, Neg=0.114, Ratio=1.00x, Gap=-0.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.114, Neg=0.114, Ratio=1.00x, Gap=-0.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.114, Neg=0.115, Ratio=1.01x, Gap=-0.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.115, Neg=0.115, Ratio=1.01x, Gap=-0.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.116, Neg=0.117, Ratio=1.01x, Gap=-0.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.116, Neg=0.117, Ratio=1.01x, Gap=-0.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.117, Neg=0.119, Ratio=1.01x, Gap=-0.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.119, Neg=0.121, Ratio=1.01x, Gap=-0.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.120, Neg=0.121, Ratio=1.01x, Gap=-0.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.121, Neg=0.123, Ratio=1.01x, Gap=-0.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.123, Neg=0.125, Ratio=1.02x, Gap=-0.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.126, Neg=0.128, Ratio=1.02x, Gap=-0.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.126, Neg=0.128, Ratio=1.01x, Gap=-0.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.130, Neg=0.133, Ratio=1.02x, Gap=-0.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.132, Neg=0.135, Ratio=1.02x, Gap=-0.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.135, Neg=0.138, Ratio=1.02x, Gap=-0.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.139, Neg=0.142, Ratio=1.02x, Gap=-0.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.142, Neg=0.145, Ratio=1.02x, Gap=-0.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.148, Neg=0.152, Ratio=1.03x, Gap=-0.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.150, Neg=0.154, Ratio=1.03x, Gap=-0.726
Batch  25/537: Loss=1.9955 (C:1.9955, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.156, Neg=0.161, Ratio=1.03x, Gap=-0.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.160, Neg=0.165, Ratio=1.03x, Gap=-0.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.165, Neg=0.170, Ratio=1.03x, Gap=-0.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.170, Neg=0.177, Ratio=1.04x, Gap=-1.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.176, Neg=0.182, Ratio=1.04x, Gap=-1.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.183, Neg=0.190, Ratio=1.04x, Gap=-1.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.195, Neg=0.203, Ratio=1.04x, Gap=-1.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.201, Neg=0.209, Ratio=1.04x, Gap=-1.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.209, Neg=0.221, Ratio=1.06x, Gap=-1.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.217, Neg=0.228, Ratio=1.05x, Gap=-1.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.225, Neg=0.235, Ratio=1.04x, Gap=-1.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.234, Neg=0.242, Ratio=1.03x, Gap=-1.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.242, Neg=0.254, Ratio=1.05x, Gap=-1.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.254, Neg=0.266, Ratio=1.05x, Gap=-2.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.270, Neg=0.285, Ratio=1.06x, Gap=-1.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.281, Neg=0.298, Ratio=1.06x, Gap=-2.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.302, Neg=0.318, Ratio=1.05x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.310, Neg=0.328, Ratio=1.06x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.320, Neg=0.339, Ratio=1.06x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.351, Neg=0.371, Ratio=1.06x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.365, Neg=0.383, Ratio=1.05x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.379, Neg=0.399, Ratio=1.05x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=0.432, Ratio=1.06x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=0.433, Ratio=1.05x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=0.466, Ratio=1.07x, Gap=-4.207
Batch  50/537: Loss=1.9766 (C:1.9766, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=0.471, Ratio=1.06x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=0.465, Ratio=1.06x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=0.506, Ratio=1.07x, Gap=-4.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=0.497, Ratio=1.07x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=0.494, Ratio=1.06x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=0.496, Ratio=1.07x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=0.504, Ratio=1.08x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=0.493, Ratio=1.07x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=0.500, Ratio=1.06x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=0.486, Ratio=1.06x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=0.501, Ratio=1.07x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=0.499, Ratio=1.07x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=0.501, Ratio=1.06x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=0.489, Ratio=1.05x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=0.505, Ratio=1.07x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=0.505, Ratio=1.07x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=0.503, Ratio=1.05x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=0.509, Ratio=1.07x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=0.503, Ratio=1.06x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=0.518, Ratio=1.06x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=0.509, Ratio=1.07x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=0.509, Ratio=1.07x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=0.527, Ratio=1.07x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=0.512, Ratio=1.06x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=0.524, Ratio=1.07x, Gap=-3.413
Batch  75/537: Loss=1.9687 (C:1.9687, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=0.510, Ratio=1.07x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=0.506, Ratio=1.07x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=0.514, Ratio=1.08x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=0.522, Ratio=1.08x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=0.508, Ratio=1.06x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=0.517, Ratio=1.06x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=0.525, Ratio=1.07x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=0.513, Ratio=1.07x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=0.519, Ratio=1.06x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=0.529, Ratio=1.09x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.535, Ratio=1.08x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.533, Ratio=1.06x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.524, Ratio=1.06x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=0.519, Ratio=1.08x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.538, Ratio=1.07x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.539, Ratio=1.07x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.529, Ratio=1.08x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=0.524, Ratio=1.07x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=0.516, Ratio=1.08x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.532, Ratio=1.07x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=0.533, Ratio=1.08x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.536, Ratio=1.07x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.534, Ratio=1.07x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=0.515, Ratio=1.06x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.526, Ratio=1.07x, Gap=-3.534
Batch 100/537: Loss=1.9699 (C:1.9699, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=0.524, Ratio=1.08x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=0.515, Ratio=1.07x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.535, Ratio=1.09x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.526, Ratio=1.07x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.545, Ratio=1.08x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.538, Ratio=1.08x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.540, Ratio=1.08x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.538, Ratio=1.07x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.546, Ratio=1.09x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.558, Ratio=1.09x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.538, Ratio=1.07x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.565, Ratio=1.09x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.549, Ratio=1.08x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.555, Ratio=1.09x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=0.524, Ratio=1.08x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.546, Ratio=1.08x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.544, Ratio=1.09x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.559, Ratio=1.10x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.546, Ratio=1.08x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.563, Ratio=1.09x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.551, Ratio=1.09x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.540, Ratio=1.08x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.561, Ratio=1.10x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.550, Ratio=1.09x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.561, Ratio=1.09x, Gap=-4.217
Batch 125/537: Loss=1.9625 (C:1.9625, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.552, Ratio=1.09x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.555, Ratio=1.08x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.555, Ratio=1.09x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.557, Ratio=1.10x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.556, Ratio=1.09x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.563, Ratio=1.09x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.562, Ratio=1.11x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.553, Ratio=1.09x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.563, Ratio=1.09x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.571, Ratio=1.09x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.584, Ratio=1.09x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.587, Ratio=1.10x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.599, Ratio=1.10x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.609, Ratio=1.10x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.594, Ratio=1.08x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.593, Ratio=1.09x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.592, Ratio=1.10x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.586, Ratio=1.10x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.574, Ratio=1.09x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.581, Ratio=1.10x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.576, Ratio=1.10x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.608, Ratio=1.13x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.577, Ratio=1.08x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.594, Ratio=1.10x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.600, Ratio=1.09x, Gap=-3.293
Batch 150/537: Loss=1.9573 (C:1.9573, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.582, Ratio=1.09x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.589, Ratio=1.10x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.564, Ratio=1.09x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.578, Ratio=1.11x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.574, Ratio=1.11x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.574, Ratio=1.11x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.579, Ratio=1.11x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.574, Ratio=1.10x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.573, Ratio=1.10x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.581, Ratio=1.11x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.589, Ratio=1.11x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.599, Ratio=1.12x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.610, Ratio=1.12x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.619, Ratio=1.13x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.611, Ratio=1.12x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.605, Ratio=1.11x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.623, Ratio=1.12x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.599, Ratio=1.11x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.604, Ratio=1.13x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.587, Ratio=1.12x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.580, Ratio=1.13x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.575, Ratio=1.12x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.569, Ratio=1.12x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.566, Ratio=1.12x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.570, Ratio=1.12x, Gap=-3.294
Batch 175/537: Loss=1.9456 (C:1.9456, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.574, Ratio=1.11x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.573, Ratio=1.13x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.590, Ratio=1.13x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.583, Ratio=1.15x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.582, Ratio=1.11x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.600, Ratio=1.15x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.588, Ratio=1.13x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.614, Ratio=1.13x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.581, Ratio=1.13x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.619, Ratio=1.15x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.616, Ratio=1.14x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.608, Ratio=1.14x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.585, Ratio=1.13x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.578, Ratio=1.10x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.594, Ratio=1.14x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.597, Ratio=1.16x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.599, Ratio=1.14x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.593, Ratio=1.15x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.591, Ratio=1.14x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.596, Ratio=1.13x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.593, Ratio=1.14x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.589, Ratio=1.13x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.578, Ratio=1.11x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.607, Ratio=1.13x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.616, Ratio=1.13x, Gap=-3.456
Batch 200/537: Loss=1.9380 (C:1.9380, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.619, Ratio=1.13x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.637, Ratio=1.15x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.621, Ratio=1.13x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.615, Ratio=1.13x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.615, Ratio=1.13x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.640, Ratio=1.15x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.641, Ratio=1.15x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.628, Ratio=1.14x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.629, Ratio=1.14x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.640, Ratio=1.16x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.632, Ratio=1.15x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.639, Ratio=1.16x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.629, Ratio=1.14x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.613, Ratio=1.13x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.624, Ratio=1.15x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.618, Ratio=1.14x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.608, Ratio=1.13x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.615, Ratio=1.14x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.614, Ratio=1.14x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.622, Ratio=1.14x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.612, Ratio=1.14x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.619, Ratio=1.16x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.609, Ratio=1.14x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.605, Ratio=1.14x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.624, Ratio=1.14x, Gap=-3.330
Batch 225/537: Loss=1.9337 (C:1.9337, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.616, Ratio=1.16x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.604, Ratio=1.14x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.629, Ratio=1.14x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.632, Ratio=1.16x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.631, Ratio=1.16x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.671, Ratio=1.16x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.668, Ratio=1.15x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.664, Ratio=1.16x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.663, Ratio=1.15x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.654, Ratio=1.14x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.670, Ratio=1.14x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.664, Ratio=1.15x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.654, Ratio=1.15x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.637, Ratio=1.14x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.652, Ratio=1.16x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.644, Ratio=1.16x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.637, Ratio=1.15x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.648, Ratio=1.16x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.634, Ratio=1.14x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.624, Ratio=1.15x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.647, Ratio=1.16x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.629, Ratio=1.15x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.653, Ratio=1.17x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.646, Ratio=1.15x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.648, Ratio=1.15x, Gap=-3.470
Batch 250/537: Loss=1.9261 (C:1.9261, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.660, Ratio=1.16x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.672, Ratio=1.14x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.648, Ratio=1.15x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.675, Ratio=1.17x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.635, Ratio=1.15x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.644, Ratio=1.14x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.633, Ratio=1.14x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.643, Ratio=1.17x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.615, Ratio=1.14x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.651, Ratio=1.18x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.626, Ratio=1.15x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.642, Ratio=1.16x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.638, Ratio=1.16x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.649, Ratio=1.17x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.655, Ratio=1.17x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.659, Ratio=1.16x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.653, Ratio=1.17x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.655, Ratio=1.16x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.668, Ratio=1.16x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.667, Ratio=1.17x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.665, Ratio=1.15x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.663, Ratio=1.16x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.660, Ratio=1.16x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.656, Ratio=1.14x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.666, Ratio=1.16x, Gap=-4.069
Batch 275/537: Loss=1.9250 (C:1.9250, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.653, Ratio=1.16x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.633, Ratio=1.16x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.628, Ratio=1.16x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.643, Ratio=1.18x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.625, Ratio=1.17x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.633, Ratio=1.17x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.626, Ratio=1.16x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.629, Ratio=1.17x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.655, Ratio=1.18x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.636, Ratio=1.17x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.643, Ratio=1.17x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.667, Ratio=1.19x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.682, Ratio=1.20x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.666, Ratio=1.17x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.673, Ratio=1.18x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.650, Ratio=1.17x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.666, Ratio=1.18x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.642, Ratio=1.16x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.647, Ratio=1.17x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.655, Ratio=1.18x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.667, Ratio=1.16x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.659, Ratio=1.16x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.669, Ratio=1.17x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.665, Ratio=1.18x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.670, Ratio=1.17x, Gap=-3.504
Batch 300/537: Loss=1.9189 (C:1.9189, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.640, Ratio=1.16x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.672, Ratio=1.19x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.663, Ratio=1.19x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.670, Ratio=1.17x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.672, Ratio=1.17x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.666, Ratio=1.15x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.663, Ratio=1.17x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.666, Ratio=1.17x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.664, Ratio=1.18x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.666, Ratio=1.16x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.685, Ratio=1.18x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.685, Ratio=1.18x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.680, Ratio=1.18x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.665, Ratio=1.18x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.680, Ratio=1.18x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.666, Ratio=1.18x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.651, Ratio=1.17x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.645, Ratio=1.18x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.647, Ratio=1.17x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.640, Ratio=1.17x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.644, Ratio=1.17x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.646, Ratio=1.18x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.640, Ratio=1.18x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.645, Ratio=1.20x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.654, Ratio=1.19x, Gap=-3.190
Batch 325/537: Loss=1.9097 (C:1.9097, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.653, Ratio=1.18x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.661, Ratio=1.17x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.676, Ratio=1.19x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.667, Ratio=1.17x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.676, Ratio=1.18x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.664, Ratio=1.18x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.670, Ratio=1.16x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.681, Ratio=1.18x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.675, Ratio=1.18x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.670, Ratio=1.18x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.682, Ratio=1.19x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.682, Ratio=1.19x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.668, Ratio=1.17x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.667, Ratio=1.18x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.695, Ratio=1.19x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.709, Ratio=1.20x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.676, Ratio=1.18x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.688, Ratio=1.19x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.675, Ratio=1.19x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.671, Ratio=1.18x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.657, Ratio=1.18x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.655, Ratio=1.19x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.630, Ratio=1.18x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.655, Ratio=1.18x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.658, Ratio=1.18x, Gap=-3.596
Batch 350/537: Loss=1.9143 (C:1.9143, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.665, Ratio=1.18x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.671, Ratio=1.17x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.681, Ratio=1.19x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.675, Ratio=1.18x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.695, Ratio=1.20x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.680, Ratio=1.18x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.677, Ratio=1.17x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.686, Ratio=1.18x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.675, Ratio=1.18x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.682, Ratio=1.19x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.677, Ratio=1.18x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.668, Ratio=1.17x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.673, Ratio=1.19x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.678, Ratio=1.19x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.669, Ratio=1.17x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.681, Ratio=1.19x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.681, Ratio=1.18x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.670, Ratio=1.18x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.675, Ratio=1.19x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.691, Ratio=1.20x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.685, Ratio=1.19x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.660, Ratio=1.19x, Gap=-3.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.680, Ratio=1.18x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.683, Ratio=1.20x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.684, Ratio=1.18x, Gap=-3.586
Batch 375/537: Loss=1.9152 (C:1.9152, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.690, Ratio=1.19x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.683, Ratio=1.18x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.703, Ratio=1.19x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.692, Ratio=1.20x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.682, Ratio=1.18x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.708, Ratio=1.18x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.702, Ratio=1.19x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.674, Ratio=1.18x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.694, Ratio=1.20x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.700, Ratio=1.20x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.702, Ratio=1.19x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.686, Ratio=1.19x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.688, Ratio=1.20x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.689, Ratio=1.20x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.670, Ratio=1.20x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.668, Ratio=1.18x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.665, Ratio=1.19x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.655, Ratio=1.18x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.678, Ratio=1.18x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.676, Ratio=1.19x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.683, Ratio=1.20x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.680, Ratio=1.18x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.676, Ratio=1.18x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.685, Ratio=1.20x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.675, Ratio=1.17x, Gap=-3.414
Batch 400/537: Loss=1.9223 (C:1.9223, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.679, Ratio=1.17x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.688, Ratio=1.20x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.706, Ratio=1.22x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.673, Ratio=1.19x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.698, Ratio=1.22x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.697, Ratio=1.20x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.703, Ratio=1.20x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.703, Ratio=1.19x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.711, Ratio=1.21x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.709, Ratio=1.19x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.720, Ratio=1.19x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.709, Ratio=1.19x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.719, Ratio=1.20x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.697, Ratio=1.20x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.671, Ratio=1.16x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.686, Ratio=1.20x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.680, Ratio=1.19x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.673, Ratio=1.17x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.686, Ratio=1.19x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.680, Ratio=1.19x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.672, Ratio=1.19x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.675, Ratio=1.21x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.679, Ratio=1.18x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.686, Ratio=1.21x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.669, Ratio=1.18x, Gap=-3.539
Batch 425/537: Loss=1.9166 (C:1.9166, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.660, Ratio=1.19x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.674, Ratio=1.18x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.677, Ratio=1.19x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.663, Ratio=1.17x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.677, Ratio=1.21x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.678, Ratio=1.20x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.675, Ratio=1.19x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.711, Ratio=1.20x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.706, Ratio=1.18x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.711, Ratio=1.20x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.722, Ratio=1.19x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.703, Ratio=1.19x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.702, Ratio=1.19x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.700, Ratio=1.21x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.694, Ratio=1.18x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.707, Ratio=1.19x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.669, Ratio=1.18x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.690, Ratio=1.18x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.698, Ratio=1.19x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.679, Ratio=1.17x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.663, Ratio=1.18x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.689, Ratio=1.18x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.685, Ratio=1.20x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.668, Ratio=1.19x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.673, Ratio=1.20x, Gap=-3.033
Batch 450/537: Loss=1.9020 (C:1.9020, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.686, Ratio=1.19x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.666, Ratio=1.19x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.685, Ratio=1.21x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.677, Ratio=1.20x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.671, Ratio=1.19x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.686, Ratio=1.20x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.673, Ratio=1.19x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.697, Ratio=1.19x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.686, Ratio=1.19x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.691, Ratio=1.19x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.691, Ratio=1.22x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.704, Ratio=1.19x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.682, Ratio=1.19x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.692, Ratio=1.19x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.695, Ratio=1.20x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.701, Ratio=1.20x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.711, Ratio=1.18x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.707, Ratio=1.19x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.696, Ratio=1.18x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.716, Ratio=1.19x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.712, Ratio=1.20x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.740, Ratio=1.20x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.705, Ratio=1.19x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.731, Ratio=1.20x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.711, Ratio=1.17x, Gap=-3.453
Batch 475/537: Loss=1.9175 (C:1.9175, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.710, Ratio=1.19x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.705, Ratio=1.19x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.702, Ratio=1.21x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.713, Ratio=1.21x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.676, Ratio=1.19x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.687, Ratio=1.18x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.698, Ratio=1.19x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.682, Ratio=1.19x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.675, Ratio=1.21x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.681, Ratio=1.19x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.694, Ratio=1.20x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.701, Ratio=1.20x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.691, Ratio=1.19x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.707, Ratio=1.19x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.700, Ratio=1.20x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.704, Ratio=1.20x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.706, Ratio=1.20x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.698, Ratio=1.19x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.678, Ratio=1.17x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.697, Ratio=1.21x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.702, Ratio=1.19x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.695, Ratio=1.19x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.686, Ratio=1.19x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.681, Ratio=1.19x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.684, Ratio=1.19x, Gap=-3.394
Batch 500/537: Loss=1.9092 (C:1.9092, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.673, Ratio=1.19x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.675, Ratio=1.19x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.683, Ratio=1.19x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.670, Ratio=1.19x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.687, Ratio=1.19x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.699, Ratio=1.20x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.706, Ratio=1.19x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.695, Ratio=1.19x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.694, Ratio=1.20x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.716, Ratio=1.19x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.702, Ratio=1.20x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.700, Ratio=1.21x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.700, Ratio=1.20x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.691, Ratio=1.19x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.684, Ratio=1.19x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.701, Ratio=1.23x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.687, Ratio=1.21x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.691, Ratio=1.19x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.698, Ratio=1.22x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.708, Ratio=1.20x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.713, Ratio=1.22x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.698, Ratio=1.20x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.723, Ratio=1.20x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.734, Ratio=1.20x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=0.743, Ratio=1.18x, Gap=-3.541
Batch 525/537: Loss=1.9167 (C:1.9167, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.732, Ratio=1.20x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.728, Ratio=1.21x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.725, Ratio=1.20x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.728, Ratio=1.21x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.718, Ratio=1.21x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.716, Ratio=1.19x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.701, Ratio=1.20x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.704, Ratio=1.21x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.709, Ratio=1.20x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.691, Ratio=1.19x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.689, Ratio=1.20x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.696, Ratio=1.23x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.699, Ratio=1.22x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.672, Ratio=1.20x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.700, Ratio=1.22x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.691, Ratio=1.23x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.685, Ratio=1.21x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.695, Ratio=1.21x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.690, Ratio=1.21x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.697, Ratio=1.21x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.704, Ratio=1.21x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.696, Ratio=1.21x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.694, Ratio=1.23x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.700, Ratio=1.24x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.692, Ratio=1.22x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.695, Ratio=1.23x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.690, Ratio=1.24x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.690, Ratio=1.22x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.695, Ratio=1.23x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.689, Ratio=1.21x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.693, Ratio=1.22x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.695, Ratio=1.24x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.695, Ratio=1.23x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.698, Ratio=1.22x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.694, Ratio=1.23x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.699, Ratio=1.23x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.667, Ratio=1.22x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.702, Ratio=1.21x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.703, Ratio=1.23x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.700, Ratio=1.22x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.699, Ratio=1.23x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.699, Ratio=1.23x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.695, Ratio=1.23x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.688, Ratio=1.21x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.688, Ratio=1.20x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.702, Ratio=1.22x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.692, Ratio=1.22x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.682, Ratio=1.21x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.690, Ratio=1.21x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.695, Ratio=1.21x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.683, Ratio=1.21x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.686, Ratio=1.23x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.697, Ratio=1.21x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.709, Ratio=1.22x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.710, Ratio=1.23x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.681, Ratio=1.22x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.697, Ratio=1.25x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.709, Ratio=1.22x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.702, Ratio=1.21x, Gap=-3.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.685, Ratio=1.22x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.691, Ratio=1.21x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.697, Ratio=1.21x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.711, Ratio=1.23x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.687, Ratio=1.22x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.699, Ratio=1.22x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.696, Ratio=1.21x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.708, Ratio=1.22x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.706, Ratio=1.24x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.686, Ratio=1.22x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.696, Ratio=1.22x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.674, Ratio=1.21x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.687, Ratio=1.23x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.696, Ratio=1.23x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.679, Ratio=1.21x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.703, Ratio=1.24x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.691, Ratio=1.20x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.684, Ratio=1.23x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.705, Ratio=1.21x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.695, Ratio=1.23x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.689, Ratio=1.22x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.692, Ratio=1.22x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.721, Ratio=1.23x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.688, Ratio=1.21x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.701, Ratio=1.23x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.700, Ratio=1.23x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.691, Ratio=1.22x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.701, Ratio=1.22x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.697, Ratio=1.22x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.694, Ratio=1.22x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.685, Ratio=1.21x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.697, Ratio=1.23x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.694, Ratio=1.21x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.700, Ratio=1.20x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.677, Ratio=1.19x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.696, Ratio=1.24x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.702, Ratio=1.22x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.690, Ratio=1.23x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.689, Ratio=1.21x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.689, Ratio=1.24x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.708, Ratio=1.23x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.681, Ratio=1.19x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.677, Ratio=1.22x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.694, Ratio=1.22x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.697, Ratio=1.22x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.688, Ratio=1.21x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.696, Ratio=1.21x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.690, Ratio=1.22x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.692, Ratio=1.22x, Gap=-3.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.704, Ratio=1.23x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.693, Ratio=1.23x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.684, Ratio=1.22x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.705, Ratio=1.24x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.686, Ratio=1.23x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.686, Ratio=1.22x, Gap=-3.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.699, Ratio=1.24x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.683, Ratio=1.21x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.683, Ratio=1.23x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.693, Ratio=1.23x, Gap=-3.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.693, Ratio=1.24x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.680, Ratio=1.22x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.688, Ratio=1.21x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.703, Ratio=1.22x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.689, Ratio=1.21x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.708, Ratio=1.24x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.676, Ratio=1.19x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.698, Ratio=1.23x, Gap=-3.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.690, Ratio=1.21x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.717, Ratio=1.24x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.702, Ratio=1.25x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.709, Ratio=1.24x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.717, Ratio=1.27x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.675, Ratio=1.21x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.686, Ratio=1.21x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.697, Ratio=1.21x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.680, Ratio=1.23x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.703, Ratio=1.23x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.697, Ratio=1.20x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.688, Ratio=1.20x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.694, Ratio=1.21x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.689, Ratio=1.21x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.700, Ratio=1.23x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.682, Ratio=1.22x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.713, Ratio=1.22x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.692, Ratio=1.22x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.678, Ratio=1.22x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.683, Ratio=1.21x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.686, Ratio=1.23x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.701, Ratio=1.25x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.687, Ratio=1.22x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.688, Ratio=1.20x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.692, Ratio=1.22x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.681, Ratio=1.23x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.680, Ratio=1.20x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.689, Ratio=1.22x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.691, Ratio=1.22x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.699, Ratio=1.24x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.682, Ratio=1.22x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.700, Ratio=1.22x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.690, Ratio=1.21x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.690, Ratio=1.21x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.680, Ratio=1.21x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.687, Ratio=1.22x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.694, Ratio=1.25x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.694, Ratio=1.23x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.700, Ratio=1.23x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.682, Ratio=1.23x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.693, Ratio=1.23x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.707, Ratio=1.22x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.693, Ratio=1.22x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.703, Ratio=1.22x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.695, Ratio=1.23x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.694, Ratio=1.23x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.696, Ratio=1.21x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.713, Ratio=1.23x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.687, Ratio=1.21x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.709, Ratio=1.24x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.698, Ratio=1.23x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.695, Ratio=1.22x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.691, Ratio=1.20x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.687, Ratio=1.20x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.690, Ratio=1.20x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.702, Ratio=1.20x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.679, Ratio=1.22x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.706, Ratio=1.23x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.684, Ratio=1.22x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.695, Ratio=1.22x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.704, Ratio=1.23x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.704, Ratio=1.23x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.698, Ratio=1.24x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.706, Ratio=1.24x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.689, Ratio=1.21x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.692, Ratio=1.23x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.691, Ratio=1.21x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.691, Ratio=1.22x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.698, Ratio=1.24x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.697, Ratio=1.25x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.698, Ratio=1.23x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.675, Ratio=1.21x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.690, Ratio=1.24x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.683, Ratio=1.21x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.686, Ratio=1.19x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.711, Ratio=1.23x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.697, Ratio=1.22x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.698, Ratio=1.22x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.713, Ratio=1.23x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.693, Ratio=1.22x, Gap=-3.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.697, Ratio=1.21x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.698, Ratio=1.22x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.693, Ratio=1.21x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.691, Ratio=1.22x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.694, Ratio=1.22x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.670, Ratio=1.22x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.691, Ratio=1.23x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.689, Ratio=1.21x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.706, Ratio=1.22x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.697, Ratio=1.23x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.689, Ratio=1.21x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.688, Ratio=1.23x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.692, Ratio=1.21x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.685, Ratio=1.22x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.694, Ratio=1.21x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.697, Ratio=1.24x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.697, Ratio=1.21x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.690, Ratio=1.22x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.693, Ratio=1.21x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.679, Ratio=1.21x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.695, Ratio=1.23x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.686, Ratio=1.23x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.695, Ratio=1.23x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.687, Ratio=1.21x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.682, Ratio=1.22x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.693, Ratio=1.21x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.702, Ratio=1.23x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.701, Ratio=1.23x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.693, Ratio=1.22x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.668, Ratio=1.20x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.694, Ratio=1.21x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.702, Ratio=1.22x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.699, Ratio=1.21x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.691, Ratio=1.22x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.706, Ratio=1.23x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.696, Ratio=1.23x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.693, Ratio=1.22x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.683, Ratio=1.22x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.694, Ratio=1.24x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.689, Ratio=1.23x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.686, Ratio=1.23x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.694, Ratio=1.22x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.707, Ratio=1.24x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.693, Ratio=1.23x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.705, Ratio=1.22x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.692, Ratio=1.23x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.686, Ratio=1.22x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.691, Ratio=1.21x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.695, Ratio=1.23x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.714, Ratio=1.23x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.684, Ratio=1.20x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.693, Ratio=1.24x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.693, Ratio=1.25x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.696, Ratio=1.24x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.698, Ratio=1.23x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.700, Ratio=1.25x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.684, Ratio=1.21x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.685, Ratio=1.21x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.685, Ratio=1.22x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.699, Ratio=1.21x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.692, Ratio=1.22x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.689, Ratio=1.23x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.701, Ratio=1.23x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.668, Ratio=1.22x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.690, Ratio=1.23x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.699, Ratio=1.22x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.700, Ratio=1.21x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.690, Ratio=1.23x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.695, Ratio=1.22x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.694, Ratio=1.24x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.682, Ratio=1.22x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.700, Ratio=1.21x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.717, Ratio=1.25x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.705, Ratio=1.23x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.690, Ratio=1.23x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.702, Ratio=1.24x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.697, Ratio=1.23x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.693, Ratio=1.22x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.693, Ratio=1.23x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.693, Ratio=1.23x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.695, Ratio=1.22x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.690, Ratio=1.24x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.697, Ratio=1.21x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.683, Ratio=1.23x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.699, Ratio=1.22x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.695, Ratio=1.22x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.700, Ratio=1.22x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.708, Ratio=1.22x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.699, Ratio=1.21x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.685, Ratio=1.20x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.703, Ratio=1.22x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.696, Ratio=1.21x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.704, Ratio=1.23x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.690, Ratio=1.24x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.709, Ratio=1.23x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.697, Ratio=1.24x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.695, Ratio=1.23x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.698, Ratio=1.23x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.695, Ratio=1.23x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.686, Ratio=1.21x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.687, Ratio=1.22x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.690, Ratio=1.21x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.686, Ratio=1.21x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.680, Ratio=1.19x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.696, Ratio=1.24x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.683, Ratio=1.23x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.691, Ratio=1.22x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.708, Ratio=1.23x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.696, Ratio=1.23x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.685, Ratio=1.22x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.695, Ratio=1.22x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.698, Ratio=1.21x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.695, Ratio=1.22x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.690, Ratio=1.22x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.705, Ratio=1.22x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.701, Ratio=1.24x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.686, Ratio=1.22x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.680, Ratio=1.22x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.685, Ratio=1.22x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.697, Ratio=1.22x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.694, Ratio=1.21x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.700, Ratio=1.25x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.684, Ratio=1.21x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.686, Ratio=1.22x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.692, Ratio=1.22x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.694, Ratio=1.23x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.680, Ratio=1.21x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.701, Ratio=1.25x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.686, Ratio=1.23x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.688, Ratio=1.23x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.713, Ratio=1.24x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.689, Ratio=1.23x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.699, Ratio=1.22x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.680, Ratio=1.22x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.685, Ratio=1.24x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.679, Ratio=1.21x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.684, Ratio=1.24x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.693, Ratio=1.23x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.691, Ratio=1.21x, Gap=-3.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.702, Ratio=1.23x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.689, Ratio=1.23x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.690, Ratio=1.21x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.704, Ratio=1.25x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.710, Ratio=1.22x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.694, Ratio=1.24x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.683, Ratio=1.21x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.695, Ratio=1.22x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.692, Ratio=1.23x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.697, Ratio=1.23x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.688, Ratio=1.21x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.683, Ratio=1.23x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.684, Ratio=1.22x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.688, Ratio=1.21x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.714, Ratio=1.24x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.680, Ratio=1.20x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.681, Ratio=1.22x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.702, Ratio=1.23x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.689, Ratio=1.21x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.701, Ratio=1.22x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.695, Ratio=1.25x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.692, Ratio=1.23x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.694, Ratio=1.23x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.678, Ratio=1.22x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.685, Ratio=1.22x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.695, Ratio=1.23x, Gap=-3.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.679, Ratio=1.21x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.698, Ratio=1.24x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.702, Ratio=1.24x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.705, Ratio=1.23x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.703, Ratio=1.22x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.697, Ratio=1.21x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.694, Ratio=1.22x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.691, Ratio=1.23x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.694, Ratio=1.24x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.701, Ratio=1.23x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.714, Ratio=1.24x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.706, Ratio=1.22x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.702, Ratio=1.22x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.696, Ratio=1.23x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.690, Ratio=1.22x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.698, Ratio=1.24x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.704, Ratio=1.23x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.695, Ratio=1.22x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.692, Ratio=1.23x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.699, Ratio=1.23x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.694, Ratio=1.23x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.684, Ratio=1.21x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.697, Ratio=1.23x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.694, Ratio=1.22x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.685, Ratio=1.23x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.712, Ratio=1.24x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.701, Ratio=1.22x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.707, Ratio=1.23x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.695, Ratio=1.21x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.700, Ratio=1.21x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.702, Ratio=1.24x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.699, Ratio=1.21x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.686, Ratio=1.21x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.697, Ratio=1.24x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.681, Ratio=1.19x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.684, Ratio=1.21x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.677, Ratio=1.21x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.698, Ratio=1.24x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.694, Ratio=1.24x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.691, Ratio=1.22x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.687, Ratio=1.22x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.680, Ratio=1.20x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.698, Ratio=1.22x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.707, Ratio=1.25x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.690, Ratio=1.22x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.684, Ratio=1.22x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.701, Ratio=1.22x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.693, Ratio=1.22x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.696, Ratio=1.24x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.699, Ratio=1.23x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.687, Ratio=1.23x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.711, Ratio=1.23x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.709, Ratio=1.23x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.686, Ratio=1.21x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.683, Ratio=1.21x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.696, Ratio=1.23x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.696, Ratio=1.23x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.703, Ratio=1.23x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.693, Ratio=1.23x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.692, Ratio=1.22x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.691, Ratio=1.23x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.710, Ratio=1.23x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.689, Ratio=1.24x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.684, Ratio=1.22x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.705, Ratio=1.24x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.697, Ratio=1.20x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.700, Ratio=1.23x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.690, Ratio=1.22x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.686, Ratio=1.21x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.705, Ratio=1.22x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.697, Ratio=1.23x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.680, Ratio=1.21x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.697, Ratio=1.22x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.699, Ratio=1.20x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.696, Ratio=1.22x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.686, Ratio=1.22x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.697, Ratio=1.23x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.699, Ratio=1.23x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.701, Ratio=1.24x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.693, Ratio=1.23x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.696, Ratio=1.22x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.711, Ratio=1.21x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.701, Ratio=1.23x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.701, Ratio=1.22x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.695, Ratio=1.23x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.704, Ratio=1.24x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.689, Ratio=1.21x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.705, Ratio=1.26x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.691, Ratio=1.23x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.707, Ratio=1.23x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.691, Ratio=1.22x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.689, Ratio=1.24x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.698, Ratio=1.22x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.698, Ratio=1.21x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.693, Ratio=1.24x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.698, Ratio=1.22x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.708, Ratio=1.22x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.699, Ratio=1.24x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.711, Ratio=1.23x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.681, Ratio=1.20x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.685, Ratio=1.21x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.687, Ratio=1.21x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.667, Ratio=1.21x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.700, Ratio=1.22x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.708, Ratio=1.22x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.709, Ratio=1.22x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.706, Ratio=1.24x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.687, Ratio=1.22x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.692, Ratio=1.22x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.696, Ratio=1.22x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.696, Ratio=1.23x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.697, Ratio=1.23x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.710, Ratio=1.22x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.702, Ratio=1.23x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.691, Ratio=1.22x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.699, Ratio=1.24x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.691, Ratio=1.22x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.700, Ratio=1.24x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.696, Ratio=1.22x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.686, Ratio=1.19x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.698, Ratio=1.24x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.680, Ratio=1.20x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.712, Ratio=1.25x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.704, Ratio=1.24x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.689, Ratio=1.20x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.689, Ratio=1.22x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.689, Ratio=1.22x, Gap=-3.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.694, Ratio=1.22x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.704, Ratio=1.22x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.695, Ratio=1.22x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.685, Ratio=1.21x, Gap=-3.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.691, Ratio=1.24x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.695, Ratio=1.22x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.706, Ratio=1.22x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.684, Ratio=1.22x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.683, Ratio=1.23x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.679, Ratio=1.21x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.710, Ratio=1.22x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.702, Ratio=1.23x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.703, Ratio=1.23x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.700, Ratio=1.22x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.691, Ratio=1.20x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.704, Ratio=1.21x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.692, Ratio=1.21x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.682, Ratio=1.21x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.695, Ratio=1.23x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.697, Ratio=1.22x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.691, Ratio=1.23x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.684, Ratio=1.24x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.680, Ratio=1.21x, Gap=-3.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.703, Ratio=1.22x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.699, Ratio=1.22x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.683, Ratio=1.20x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.696, Ratio=1.24x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.691, Ratio=1.21x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.692, Ratio=1.22x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.686, Ratio=1.23x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.691, Ratio=1.24x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.711, Ratio=1.23x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.700, Ratio=1.23x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.686, Ratio=1.22x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.714, Ratio=1.24x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.689, Ratio=1.22x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.694, Ratio=1.22x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.685, Ratio=1.20x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.701, Ratio=1.24x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.681, Ratio=1.21x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.702, Ratio=1.21x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.706, Ratio=1.24x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.701, Ratio=1.23x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.688, Ratio=1.21x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.701, Ratio=1.22x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.698, Ratio=1.22x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.704, Ratio=1.24x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.687, Ratio=1.23x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.696, Ratio=1.22x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.689, Ratio=1.23x, Gap=-3.114

============================================================
Epoch 1/20 completed in 39.1s
Train: Loss=1.9346 (C:1.9346, R:0.0000) Ratio=1.62x
Val:   Loss=1.8926 (C:1.8926, R:0.0000) Ratio=2.20x
‚úÖ New best model saved (Val Loss: 1.8926)
============================================================

Epoch 2 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.711, Ratio=1.22x, Gap=-3.553
Batch   0/537: Loss=1.8951 (C:1.8951, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.696, Ratio=1.19x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.687, Ratio=1.20x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.686, Ratio=1.21x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.701, Ratio=1.21x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.686, Ratio=1.21x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.693, Ratio=1.21x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.728, Ratio=1.22x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.718, Ratio=1.21x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.725, Ratio=1.23x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.722, Ratio=1.21x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.758, Ratio=1.21x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.737, Ratio=1.21x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.735, Ratio=1.22x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.741, Ratio=1.21x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.722, Ratio=1.21x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.732, Ratio=1.23x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.730, Ratio=1.22x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.713, Ratio=1.20x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.703, Ratio=1.19x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.713, Ratio=1.22x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.711, Ratio=1.20x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.693, Ratio=1.20x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.690, Ratio=1.21x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.693, Ratio=1.20x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.692, Ratio=1.21x, Gap=-3.370
Batch  25/537: Loss=1.8986 (C:1.8986, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.694, Ratio=1.21x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.705, Ratio=1.21x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.681, Ratio=1.20x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.703, Ratio=1.21x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.689, Ratio=1.21x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.689, Ratio=1.21x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.716, Ratio=1.22x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.703, Ratio=1.21x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.719, Ratio=1.25x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.725, Ratio=1.22x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.716, Ratio=1.22x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.718, Ratio=1.20x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.728, Ratio=1.21x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.719, Ratio=1.21x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.725, Ratio=1.21x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.703, Ratio=1.21x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.714, Ratio=1.20x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.699, Ratio=1.19x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.709, Ratio=1.20x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.722, Ratio=1.22x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.709, Ratio=1.21x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.716, Ratio=1.23x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.714, Ratio=1.22x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.697, Ratio=1.21x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.716, Ratio=1.20x, Gap=-3.298
Batch  50/537: Loss=1.9061 (C:1.9061, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.726, Ratio=1.20x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.701, Ratio=1.20x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.714, Ratio=1.21x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.737, Ratio=1.23x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.731, Ratio=1.21x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.712, Ratio=1.21x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.716, Ratio=1.20x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.731, Ratio=1.21x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.712, Ratio=1.21x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.708, Ratio=1.21x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.707, Ratio=1.21x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.721, Ratio=1.22x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.711, Ratio=1.21x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.709, Ratio=1.23x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.692, Ratio=1.22x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.694, Ratio=1.22x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.702, Ratio=1.22x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.710, Ratio=1.23x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.715, Ratio=1.22x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.714, Ratio=1.21x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.718, Ratio=1.23x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.716, Ratio=1.22x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.710, Ratio=1.22x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.703, Ratio=1.22x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.709, Ratio=1.19x, Gap=-3.703
Batch  75/537: Loss=1.9094 (C:1.9094, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.733, Ratio=1.22x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.722, Ratio=1.22x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.706, Ratio=1.20x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.712, Ratio=1.21x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.722, Ratio=1.22x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.716, Ratio=1.22x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.705, Ratio=1.19x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.727, Ratio=1.21x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.727, Ratio=1.22x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.719, Ratio=1.20x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.743, Ratio=1.21x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.719, Ratio=1.22x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.712, Ratio=1.21x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.745, Ratio=1.23x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.739, Ratio=1.22x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.717, Ratio=1.21x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.729, Ratio=1.25x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.729, Ratio=1.21x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.714, Ratio=1.19x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.719, Ratio=1.21x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.721, Ratio=1.23x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.691, Ratio=1.21x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.698, Ratio=1.21x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.705, Ratio=1.20x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.713, Ratio=1.23x, Gap=-3.283
Batch 100/537: Loss=1.8897 (C:1.8897, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.698, Ratio=1.22x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.702, Ratio=1.23x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.722, Ratio=1.21x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.704, Ratio=1.21x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.721, Ratio=1.20x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.705, Ratio=1.21x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.712, Ratio=1.22x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.719, Ratio=1.21x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.725, Ratio=1.22x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.717, Ratio=1.21x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.716, Ratio=1.22x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.720, Ratio=1.20x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.719, Ratio=1.22x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.706, Ratio=1.21x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.736, Ratio=1.21x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.710, Ratio=1.22x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.710, Ratio=1.21x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.727, Ratio=1.21x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.739, Ratio=1.23x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.745, Ratio=1.23x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.737, Ratio=1.22x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.745, Ratio=1.24x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.755, Ratio=1.22x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.744, Ratio=1.22x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.753, Ratio=1.21x, Gap=-3.604
Batch 125/537: Loss=1.8952 (C:1.8952, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.733, Ratio=1.20x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.731, Ratio=1.21x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.713, Ratio=1.21x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.723, Ratio=1.22x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.720, Ratio=1.21x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.712, Ratio=1.20x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.720, Ratio=1.23x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.704, Ratio=1.20x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.705, Ratio=1.21x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.687, Ratio=1.22x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.731, Ratio=1.22x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.727, Ratio=1.22x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.712, Ratio=1.20x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.732, Ratio=1.22x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.739, Ratio=1.21x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.735, Ratio=1.21x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.732, Ratio=1.21x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.721, Ratio=1.21x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.730, Ratio=1.23x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.739, Ratio=1.24x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.722, Ratio=1.21x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.730, Ratio=1.21x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.723, Ratio=1.22x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.728, Ratio=1.21x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.742, Ratio=1.23x, Gap=-3.462
Batch 150/537: Loss=1.8895 (C:1.8895, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.714, Ratio=1.21x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.705, Ratio=1.21x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.720, Ratio=1.21x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.730, Ratio=1.22x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.708, Ratio=1.20x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.715, Ratio=1.22x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.715, Ratio=1.21x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.703, Ratio=1.21x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.723, Ratio=1.23x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.696, Ratio=1.21x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.732, Ratio=1.22x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.717, Ratio=1.21x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.701, Ratio=1.22x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.717, Ratio=1.22x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.706, Ratio=1.21x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.711, Ratio=1.22x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.724, Ratio=1.23x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.737, Ratio=1.22x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.724, Ratio=1.22x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.741, Ratio=1.22x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.725, Ratio=1.21x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.738, Ratio=1.22x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.734, Ratio=1.21x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.747, Ratio=1.21x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.748, Ratio=1.22x, Gap=-3.434
Batch 175/537: Loss=1.8941 (C:1.8941, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.731, Ratio=1.23x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.737, Ratio=1.22x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.724, Ratio=1.20x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.726, Ratio=1.22x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.725, Ratio=1.23x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.716, Ratio=1.23x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.714, Ratio=1.21x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.716, Ratio=1.23x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.718, Ratio=1.23x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.731, Ratio=1.22x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.716, Ratio=1.20x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.702, Ratio=1.20x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.734, Ratio=1.23x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.725, Ratio=1.22x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.726, Ratio=1.20x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.720, Ratio=1.20x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.737, Ratio=1.24x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.729, Ratio=1.21x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.738, Ratio=1.21x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.743, Ratio=1.23x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.726, Ratio=1.20x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.740, Ratio=1.23x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.719, Ratio=1.23x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.718, Ratio=1.24x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.715, Ratio=1.22x, Gap=-3.194
Batch 200/537: Loss=1.8927 (C:1.8927, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.715, Ratio=1.20x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.736, Ratio=1.24x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.715, Ratio=1.23x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.712, Ratio=1.23x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.727, Ratio=1.22x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.737, Ratio=1.24x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.723, Ratio=1.20x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.734, Ratio=1.23x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.717, Ratio=1.21x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.733, Ratio=1.22x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.730, Ratio=1.25x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.728, Ratio=1.21x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.749, Ratio=1.20x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.751, Ratio=1.20x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.744, Ratio=1.19x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.730, Ratio=1.21x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.734, Ratio=1.21x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.741, Ratio=1.20x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.737, Ratio=1.24x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.721, Ratio=1.22x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.695, Ratio=1.20x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.724, Ratio=1.23x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.712, Ratio=1.22x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.726, Ratio=1.22x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.706, Ratio=1.21x, Gap=-3.588
Batch 225/537: Loss=1.8989 (C:1.8989, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.726, Ratio=1.23x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.708, Ratio=1.21x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.705, Ratio=1.20x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.714, Ratio=1.22x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.723, Ratio=1.24x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.727, Ratio=1.22x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.725, Ratio=1.22x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.727, Ratio=1.22x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.717, Ratio=1.22x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.712, Ratio=1.25x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.727, Ratio=1.24x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.757, Ratio=1.24x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.730, Ratio=1.21x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.721, Ratio=1.20x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.732, Ratio=1.22x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.738, Ratio=1.21x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.734, Ratio=1.22x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.745, Ratio=1.24x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.737, Ratio=1.24x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.772, Ratio=1.25x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.755, Ratio=1.24x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.765, Ratio=1.24x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.756, Ratio=1.23x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.751, Ratio=1.21x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.763, Ratio=1.23x, Gap=-3.179
Batch 250/537: Loss=1.8868 (C:1.8868, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.761, Ratio=1.24x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=0.771, Ratio=1.22x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.767, Ratio=1.24x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.749, Ratio=1.20x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.753, Ratio=1.20x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.758, Ratio=1.24x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.734, Ratio=1.21x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.746, Ratio=1.23x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.751, Ratio=1.23x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.714, Ratio=1.22x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.726, Ratio=1.21x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.715, Ratio=1.22x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.702, Ratio=1.21x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.704, Ratio=1.21x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.695, Ratio=1.22x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.707, Ratio=1.23x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.711, Ratio=1.22x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.703, Ratio=1.20x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.700, Ratio=1.20x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.696, Ratio=1.20x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.713, Ratio=1.24x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.737, Ratio=1.22x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.729, Ratio=1.22x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.752, Ratio=1.23x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.741, Ratio=1.23x, Gap=-3.478
Batch 275/537: Loss=1.8902 (C:1.8902, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.733, Ratio=1.19x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.766, Ratio=1.23x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.761, Ratio=1.23x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.740, Ratio=1.22x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.746, Ratio=1.21x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.751, Ratio=1.23x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.740, Ratio=1.24x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.734, Ratio=1.22x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.742, Ratio=1.23x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.725, Ratio=1.24x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.697, Ratio=1.21x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.730, Ratio=1.21x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.728, Ratio=1.21x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.699, Ratio=1.22x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.722, Ratio=1.21x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.708, Ratio=1.21x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.715, Ratio=1.24x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.731, Ratio=1.22x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.730, Ratio=1.23x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.734, Ratio=1.22x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.736, Ratio=1.24x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.742, Ratio=1.23x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.746, Ratio=1.23x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.739, Ratio=1.23x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.735, Ratio=1.22x, Gap=-3.527
Batch 300/537: Loss=1.8951 (C:1.8951, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.738, Ratio=1.20x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.734, Ratio=1.21x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.757, Ratio=1.25x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.735, Ratio=1.20x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.729, Ratio=1.22x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.740, Ratio=1.22x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.764, Ratio=1.23x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.741, Ratio=1.23x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.724, Ratio=1.22x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.732, Ratio=1.23x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.718, Ratio=1.22x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.708, Ratio=1.22x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.733, Ratio=1.22x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.724, Ratio=1.21x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.724, Ratio=1.23x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.726, Ratio=1.24x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.708, Ratio=1.21x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.721, Ratio=1.23x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.718, Ratio=1.22x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.734, Ratio=1.25x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.727, Ratio=1.21x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.732, Ratio=1.22x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.701, Ratio=1.21x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.736, Ratio=1.22x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.732, Ratio=1.24x, Gap=-3.333
Batch 325/537: Loss=1.8840 (C:1.8840, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.730, Ratio=1.21x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.750, Ratio=1.24x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.757, Ratio=1.23x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.725, Ratio=1.22x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.736, Ratio=1.20x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.735, Ratio=1.23x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.731, Ratio=1.22x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.729, Ratio=1.22x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.742, Ratio=1.23x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.743, Ratio=1.23x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.733, Ratio=1.21x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.751, Ratio=1.24x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.746, Ratio=1.22x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.723, Ratio=1.20x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.730, Ratio=1.24x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.723, Ratio=1.24x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.743, Ratio=1.24x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.734, Ratio=1.21x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.717, Ratio=1.20x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.737, Ratio=1.23x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.737, Ratio=1.22x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.735, Ratio=1.21x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.740, Ratio=1.24x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.770, Ratio=1.27x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.730, Ratio=1.21x, Gap=-3.646
Batch 350/537: Loss=1.8996 (C:1.8996, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.739, Ratio=1.21x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.749, Ratio=1.22x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.744, Ratio=1.20x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.729, Ratio=1.22x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.751, Ratio=1.22x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.752, Ratio=1.23x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.730, Ratio=1.22x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.743, Ratio=1.23x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.738, Ratio=1.23x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.755, Ratio=1.25x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.716, Ratio=1.22x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.736, Ratio=1.23x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.737, Ratio=1.21x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.731, Ratio=1.22x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.735, Ratio=1.24x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.744, Ratio=1.21x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.728, Ratio=1.22x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.739, Ratio=1.21x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.754, Ratio=1.23x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.732, Ratio=1.22x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.739, Ratio=1.23x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.736, Ratio=1.22x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.748, Ratio=1.24x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.734, Ratio=1.22x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.756, Ratio=1.23x, Gap=-3.421
Batch 375/537: Loss=1.8899 (C:1.8899, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.729, Ratio=1.21x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.735, Ratio=1.22x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.746, Ratio=1.23x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.740, Ratio=1.22x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.736, Ratio=1.22x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.730, Ratio=1.22x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.718, Ratio=1.22x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.742, Ratio=1.26x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.712, Ratio=1.23x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.733, Ratio=1.22x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.729, Ratio=1.24x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.732, Ratio=1.22x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.735, Ratio=1.24x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.759, Ratio=1.22x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.755, Ratio=1.22x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.768, Ratio=1.22x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.747, Ratio=1.22x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.747, Ratio=1.23x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.746, Ratio=1.23x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.740, Ratio=1.23x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.746, Ratio=1.23x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.724, Ratio=1.22x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.736, Ratio=1.23x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.734, Ratio=1.24x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.721, Ratio=1.23x, Gap=-3.116
Batch 400/537: Loss=1.8898 (C:1.8898, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.724, Ratio=1.23x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.728, Ratio=1.23x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.713, Ratio=1.23x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.726, Ratio=1.21x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.713, Ratio=1.23x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.727, Ratio=1.22x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.736, Ratio=1.22x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.741, Ratio=1.24x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.724, Ratio=1.23x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.726, Ratio=1.22x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.758, Ratio=1.22x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.762, Ratio=1.26x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.737, Ratio=1.22x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.756, Ratio=1.22x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.754, Ratio=1.24x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.739, Ratio=1.21x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.734, Ratio=1.22x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.727, Ratio=1.21x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.750, Ratio=1.23x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.739, Ratio=1.24x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.725, Ratio=1.22x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.724, Ratio=1.23x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.736, Ratio=1.24x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.738, Ratio=1.23x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.733, Ratio=1.22x, Gap=-3.368
Batch 425/537: Loss=1.8933 (C:1.8933, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.723, Ratio=1.23x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.730, Ratio=1.23x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.749, Ratio=1.23x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.738, Ratio=1.23x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.741, Ratio=1.23x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.738, Ratio=1.24x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.745, Ratio=1.24x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.765, Ratio=1.25x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.753, Ratio=1.24x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.739, Ratio=1.22x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.722, Ratio=1.23x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.745, Ratio=1.24x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.727, Ratio=1.21x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.734, Ratio=1.22x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.731, Ratio=1.22x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.717, Ratio=1.20x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.746, Ratio=1.22x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.754, Ratio=1.25x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.729, Ratio=1.23x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.727, Ratio=1.21x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.756, Ratio=1.22x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.750, Ratio=1.23x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.755, Ratio=1.23x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.764, Ratio=1.23x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.756, Ratio=1.21x, Gap=-3.297
Batch 450/537: Loss=1.8964 (C:1.8964, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.742, Ratio=1.24x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.759, Ratio=1.26x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.740, Ratio=1.22x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.754, Ratio=1.24x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.746, Ratio=1.22x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.747, Ratio=1.24x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.745, Ratio=1.25x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.736, Ratio=1.26x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.727, Ratio=1.20x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.737, Ratio=1.23x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.745, Ratio=1.23x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.751, Ratio=1.24x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.746, Ratio=1.23x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.744, Ratio=1.24x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.741, Ratio=1.22x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.716, Ratio=1.23x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.732, Ratio=1.24x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.735, Ratio=1.23x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.725, Ratio=1.23x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.721, Ratio=1.24x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.727, Ratio=1.22x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.744, Ratio=1.24x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.738, Ratio=1.23x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.724, Ratio=1.21x, Gap=-3.492
Batch 475/537: Loss=1.8981 (C:1.8981, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.738, Ratio=1.23x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.737, Ratio=1.23x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.754, Ratio=1.25x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.741, Ratio=1.22x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.750, Ratio=1.25x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.751, Ratio=1.24x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.735, Ratio=1.21x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.745, Ratio=1.24x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.748, Ratio=1.24x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.745, Ratio=1.23x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.731, Ratio=1.22x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.753, Ratio=1.24x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.751, Ratio=1.23x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.747, Ratio=1.22x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.750, Ratio=1.22x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.763, Ratio=1.22x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.759, Ratio=1.22x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.750, Ratio=1.22x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.740, Ratio=1.23x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.760, Ratio=1.25x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.734, Ratio=1.23x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.726, Ratio=1.22x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.736, Ratio=1.22x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.723, Ratio=1.25x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.712, Ratio=1.21x, Gap=-3.224
Batch 500/537: Loss=1.9000 (C:1.9000, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.723, Ratio=1.21x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.738, Ratio=1.25x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.711, Ratio=1.23x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.729, Ratio=1.23x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.722, Ratio=1.24x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.716, Ratio=1.24x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.723, Ratio=1.23x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.728, Ratio=1.25x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.725, Ratio=1.23x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.725, Ratio=1.25x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.739, Ratio=1.26x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.744, Ratio=1.24x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.730, Ratio=1.23x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.726, Ratio=1.24x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.752, Ratio=1.21x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.754, Ratio=1.23x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.765, Ratio=1.23x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.753, Ratio=1.23x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.750, Ratio=1.21x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.734, Ratio=1.23x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.742, Ratio=1.22x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.737, Ratio=1.22x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.758, Ratio=1.25x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.735, Ratio=1.22x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.741, Ratio=1.23x, Gap=-3.472
Batch 525/537: Loss=1.8898 (C:1.8898, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.742, Ratio=1.22x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.740, Ratio=1.22x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.733, Ratio=1.22x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.735, Ratio=1.24x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.741, Ratio=1.25x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.726, Ratio=1.21x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.735, Ratio=1.23x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.733, Ratio=1.24x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.734, Ratio=1.23x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.719, Ratio=1.21x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.741, Ratio=1.25x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.746, Ratio=1.25x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.740, Ratio=1.24x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.736, Ratio=1.24x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.745, Ratio=1.26x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.746, Ratio=1.26x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.741, Ratio=1.26x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.743, Ratio=1.26x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.736, Ratio=1.27x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.744, Ratio=1.25x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.751, Ratio=1.27x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.754, Ratio=1.24x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.743, Ratio=1.26x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.737, Ratio=1.24x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.741, Ratio=1.25x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.754, Ratio=1.26x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.753, Ratio=1.26x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.759, Ratio=1.28x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.730, Ratio=1.23x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.741, Ratio=1.26x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.732, Ratio=1.25x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.733, Ratio=1.24x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.741, Ratio=1.26x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.732, Ratio=1.25x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.739, Ratio=1.24x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.735, Ratio=1.25x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.734, Ratio=1.24x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.731, Ratio=1.27x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.754, Ratio=1.26x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.727, Ratio=1.24x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.744, Ratio=1.27x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.731, Ratio=1.26x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.740, Ratio=1.26x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.735, Ratio=1.24x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.756, Ratio=1.26x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.736, Ratio=1.24x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.742, Ratio=1.26x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.754, Ratio=1.27x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.730, Ratio=1.24x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.756, Ratio=1.27x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.736, Ratio=1.25x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.746, Ratio=1.25x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.732, Ratio=1.23x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.742, Ratio=1.27x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.751, Ratio=1.25x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.726, Ratio=1.25x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.730, Ratio=1.24x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.753, Ratio=1.27x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.742, Ratio=1.25x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.749, Ratio=1.26x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.750, Ratio=1.26x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.736, Ratio=1.26x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.717, Ratio=1.23x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.757, Ratio=1.29x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.742, Ratio=1.26x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.735, Ratio=1.25x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.750, Ratio=1.25x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.741, Ratio=1.24x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.736, Ratio=1.25x, Gap=-3.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.738, Ratio=1.27x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.743, Ratio=1.24x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.734, Ratio=1.24x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.729, Ratio=1.24x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.724, Ratio=1.25x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.752, Ratio=1.26x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.730, Ratio=1.23x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.739, Ratio=1.23x, Gap=-3.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.738, Ratio=1.27x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.752, Ratio=1.26x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.763, Ratio=1.27x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.734, Ratio=1.25x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.736, Ratio=1.27x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.756, Ratio=1.28x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.732, Ratio=1.25x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.739, Ratio=1.23x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.740, Ratio=1.23x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.748, Ratio=1.26x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.750, Ratio=1.27x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.729, Ratio=1.24x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.746, Ratio=1.27x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.736, Ratio=1.23x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.723, Ratio=1.23x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.738, Ratio=1.25x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.740, Ratio=1.27x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.729, Ratio=1.24x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.753, Ratio=1.27x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.736, Ratio=1.24x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.736, Ratio=1.26x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.742, Ratio=1.25x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.730, Ratio=1.26x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.740, Ratio=1.26x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.741, Ratio=1.25x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.752, Ratio=1.26x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.742, Ratio=1.24x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.752, Ratio=1.26x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.743, Ratio=1.25x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.749, Ratio=1.26x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.751, Ratio=1.27x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.756, Ratio=1.25x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.726, Ratio=1.25x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.737, Ratio=1.26x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.740, Ratio=1.24x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.734, Ratio=1.25x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.743, Ratio=1.25x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.729, Ratio=1.24x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.749, Ratio=1.27x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.735, Ratio=1.22x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.757, Ratio=1.28x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.738, Ratio=1.26x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.723, Ratio=1.25x, Gap=-3.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.734, Ratio=1.24x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.729, Ratio=1.24x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.746, Ratio=1.25x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.748, Ratio=1.25x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.750, Ratio=1.26x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.747, Ratio=1.24x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.748, Ratio=1.26x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.719, Ratio=1.24x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.744, Ratio=1.26x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.738, Ratio=1.27x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.737, Ratio=1.26x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.735, Ratio=1.24x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.749, Ratio=1.26x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.740, Ratio=1.26x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.747, Ratio=1.26x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.750, Ratio=1.26x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.740, Ratio=1.25x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.732, Ratio=1.25x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.745, Ratio=1.28x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.726, Ratio=1.24x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.743, Ratio=1.25x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.745, Ratio=1.28x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.738, Ratio=1.24x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.743, Ratio=1.27x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.752, Ratio=1.26x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.749, Ratio=1.26x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.750, Ratio=1.26x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.746, Ratio=1.26x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.725, Ratio=1.24x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.738, Ratio=1.24x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.742, Ratio=1.25x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.731, Ratio=1.25x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.735, Ratio=1.27x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.739, Ratio=1.26x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.740, Ratio=1.24x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.747, Ratio=1.26x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.740, Ratio=1.24x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.738, Ratio=1.24x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.730, Ratio=1.24x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.741, Ratio=1.27x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.734, Ratio=1.25x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.730, Ratio=1.24x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.747, Ratio=1.28x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.737, Ratio=1.24x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.760, Ratio=1.27x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.735, Ratio=1.24x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.734, Ratio=1.26x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.741, Ratio=1.24x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.751, Ratio=1.25x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.739, Ratio=1.25x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.741, Ratio=1.27x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.732, Ratio=1.24x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.731, Ratio=1.24x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.743, Ratio=1.27x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.740, Ratio=1.27x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.745, Ratio=1.25x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.735, Ratio=1.25x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.742, Ratio=1.26x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.746, Ratio=1.26x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.745, Ratio=1.27x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.753, Ratio=1.28x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.734, Ratio=1.24x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.745, Ratio=1.26x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.743, Ratio=1.27x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.739, Ratio=1.26x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.737, Ratio=1.25x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.738, Ratio=1.28x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.754, Ratio=1.28x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.742, Ratio=1.26x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.740, Ratio=1.25x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.730, Ratio=1.26x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.751, Ratio=1.26x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.739, Ratio=1.26x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.749, Ratio=1.25x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.744, Ratio=1.26x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.719, Ratio=1.25x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.729, Ratio=1.24x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.738, Ratio=1.24x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.747, Ratio=1.27x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.736, Ratio=1.26x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.747, Ratio=1.26x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.748, Ratio=1.26x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.741, Ratio=1.29x, Gap=-3.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.723, Ratio=1.24x, Gap=-3.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.756, Ratio=1.26x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.742, Ratio=1.25x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.741, Ratio=1.25x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.753, Ratio=1.26x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.748, Ratio=1.25x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.737, Ratio=1.24x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.741, Ratio=1.25x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.767, Ratio=1.29x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.739, Ratio=1.25x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.737, Ratio=1.26x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.742, Ratio=1.26x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.725, Ratio=1.24x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.751, Ratio=1.26x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.733, Ratio=1.24x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.738, Ratio=1.25x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.746, Ratio=1.27x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.730, Ratio=1.24x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.735, Ratio=1.27x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.742, Ratio=1.27x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.762, Ratio=1.26x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.738, Ratio=1.25x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.733, Ratio=1.26x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.743, Ratio=1.25x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.742, Ratio=1.25x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.752, Ratio=1.25x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.739, Ratio=1.27x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.743, Ratio=1.24x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.763, Ratio=1.28x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.745, Ratio=1.27x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.723, Ratio=1.25x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.748, Ratio=1.25x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.733, Ratio=1.25x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.729, Ratio=1.26x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.734, Ratio=1.25x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.754, Ratio=1.27x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.732, Ratio=1.24x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.748, Ratio=1.27x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.724, Ratio=1.22x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.737, Ratio=1.25x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.733, Ratio=1.26x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.729, Ratio=1.25x, Gap=-3.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.736, Ratio=1.25x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.728, Ratio=1.25x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.736, Ratio=1.27x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.729, Ratio=1.25x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.741, Ratio=1.25x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.743, Ratio=1.26x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.744, Ratio=1.26x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.749, Ratio=1.25x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.744, Ratio=1.24x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.735, Ratio=1.22x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.729, Ratio=1.25x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.734, Ratio=1.26x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.741, Ratio=1.26x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.731, Ratio=1.27x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.721, Ratio=1.25x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.750, Ratio=1.27x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.724, Ratio=1.25x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.738, Ratio=1.25x, Gap=-3.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.755, Ratio=1.27x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.725, Ratio=1.24x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.736, Ratio=1.24x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.739, Ratio=1.24x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.744, Ratio=1.25x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.736, Ratio=1.24x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.743, Ratio=1.26x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.754, Ratio=1.25x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.748, Ratio=1.26x, Gap=-3.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.747, Ratio=1.26x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.736, Ratio=1.25x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.730, Ratio=1.24x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.736, Ratio=1.26x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.744, Ratio=1.25x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.754, Ratio=1.25x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.748, Ratio=1.28x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.733, Ratio=1.23x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.748, Ratio=1.25x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.743, Ratio=1.25x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.729, Ratio=1.25x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.729, Ratio=1.24x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.742, Ratio=1.26x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.746, Ratio=1.26x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.742, Ratio=1.27x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.729, Ratio=1.25x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.749, Ratio=1.27x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.734, Ratio=1.25x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.735, Ratio=1.23x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.746, Ratio=1.25x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.739, Ratio=1.24x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.744, Ratio=1.24x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.719, Ratio=1.24x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.731, Ratio=1.25x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.754, Ratio=1.27x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.729, Ratio=1.24x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.758, Ratio=1.26x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.736, Ratio=1.25x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.748, Ratio=1.25x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.730, Ratio=1.25x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.738, Ratio=1.25x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.726, Ratio=1.26x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.748, Ratio=1.26x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.732, Ratio=1.27x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.746, Ratio=1.23x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.733, Ratio=1.25x, Gap=-3.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.736, Ratio=1.23x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.744, Ratio=1.26x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.742, Ratio=1.24x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.736, Ratio=1.25x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.739, Ratio=1.26x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.739, Ratio=1.25x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.745, Ratio=1.25x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.750, Ratio=1.24x, Gap=-3.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.741, Ratio=1.26x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.738, Ratio=1.25x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.746, Ratio=1.25x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.745, Ratio=1.26x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.754, Ratio=1.26x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.744, Ratio=1.26x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.746, Ratio=1.26x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.731, Ratio=1.23x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.736, Ratio=1.24x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.741, Ratio=1.25x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.729, Ratio=1.24x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.746, Ratio=1.27x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.751, Ratio=1.30x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.739, Ratio=1.27x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.739, Ratio=1.26x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.741, Ratio=1.25x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.743, Ratio=1.25x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.740, Ratio=1.27x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.738, Ratio=1.25x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.757, Ratio=1.27x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.734, Ratio=1.24x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.733, Ratio=1.25x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.740, Ratio=1.25x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.748, Ratio=1.26x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.744, Ratio=1.25x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.740, Ratio=1.27x, Gap=-3.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.724, Ratio=1.25x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.737, Ratio=1.25x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.735, Ratio=1.24x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.733, Ratio=1.24x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.742, Ratio=1.27x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.734, Ratio=1.25x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.742, Ratio=1.26x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.731, Ratio=1.26x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.734, Ratio=1.26x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.745, Ratio=1.26x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.726, Ratio=1.24x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.743, Ratio=1.25x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.747, Ratio=1.26x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.751, Ratio=1.24x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.758, Ratio=1.27x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.738, Ratio=1.25x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.732, Ratio=1.25x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.741, Ratio=1.24x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.744, Ratio=1.26x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.733, Ratio=1.24x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.730, Ratio=1.24x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.723, Ratio=1.24x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.739, Ratio=1.25x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.756, Ratio=1.25x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.746, Ratio=1.26x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.736, Ratio=1.25x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.728, Ratio=1.25x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.723, Ratio=1.24x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.740, Ratio=1.26x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.755, Ratio=1.26x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.742, Ratio=1.25x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.735, Ratio=1.26x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.743, Ratio=1.24x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.735, Ratio=1.24x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.735, Ratio=1.25x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.721, Ratio=1.22x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.750, Ratio=1.26x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.728, Ratio=1.25x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.747, Ratio=1.24x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.748, Ratio=1.28x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.744, Ratio=1.27x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.734, Ratio=1.25x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.738, Ratio=1.25x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.754, Ratio=1.26x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.732, Ratio=1.26x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.750, Ratio=1.26x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.755, Ratio=1.27x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.741, Ratio=1.27x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.740, Ratio=1.25x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.746, Ratio=1.26x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.739, Ratio=1.25x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.743, Ratio=1.25x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.736, Ratio=1.26x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.747, Ratio=1.26x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.719, Ratio=1.23x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.756, Ratio=1.27x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.741, Ratio=1.25x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.738, Ratio=1.26x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.737, Ratio=1.26x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.740, Ratio=1.27x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.734, Ratio=1.25x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.731, Ratio=1.24x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.743, Ratio=1.26x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.737, Ratio=1.24x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.733, Ratio=1.25x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.730, Ratio=1.25x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.726, Ratio=1.25x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.739, Ratio=1.26x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.732, Ratio=1.24x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.750, Ratio=1.26x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.750, Ratio=1.26x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.756, Ratio=1.26x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.746, Ratio=1.25x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.746, Ratio=1.26x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.735, Ratio=1.25x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.752, Ratio=1.25x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.742, Ratio=1.25x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.741, Ratio=1.25x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.747, Ratio=1.28x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.751, Ratio=1.27x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.740, Ratio=1.25x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.736, Ratio=1.24x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.729, Ratio=1.26x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.748, Ratio=1.28x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.736, Ratio=1.25x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.739, Ratio=1.25x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.740, Ratio=1.27x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.740, Ratio=1.26x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.735, Ratio=1.25x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.734, Ratio=1.25x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.757, Ratio=1.26x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.733, Ratio=1.25x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.733, Ratio=1.25x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.742, Ratio=1.24x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.745, Ratio=1.26x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.742, Ratio=1.25x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.737, Ratio=1.24x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.730, Ratio=1.24x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.736, Ratio=1.27x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.758, Ratio=1.25x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.744, Ratio=1.26x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.739, Ratio=1.25x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.740, Ratio=1.23x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.748, Ratio=1.25x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.733, Ratio=1.29x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.752, Ratio=1.25x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.746, Ratio=1.25x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.724, Ratio=1.24x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.734, Ratio=1.24x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.736, Ratio=1.28x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.748, Ratio=1.26x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.732, Ratio=1.24x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.731, Ratio=1.24x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.735, Ratio=1.25x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.745, Ratio=1.25x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.750, Ratio=1.26x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.745, Ratio=1.26x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.734, Ratio=1.26x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.739, Ratio=1.26x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.738, Ratio=1.26x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.743, Ratio=1.25x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.732, Ratio=1.24x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.744, Ratio=1.24x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.730, Ratio=1.24x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.755, Ratio=1.26x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.744, Ratio=1.24x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.743, Ratio=1.22x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.746, Ratio=1.24x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.746, Ratio=1.27x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.736, Ratio=1.24x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.742, Ratio=1.26x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.744, Ratio=1.26x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.734, Ratio=1.27x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.730, Ratio=1.25x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.748, Ratio=1.25x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.762, Ratio=1.28x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.746, Ratio=1.24x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.746, Ratio=1.24x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.744, Ratio=1.26x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.728, Ratio=1.25x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.750, Ratio=1.28x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.725, Ratio=1.25x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.749, Ratio=1.23x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.734, Ratio=1.25x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.742, Ratio=1.24x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.742, Ratio=1.25x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.741, Ratio=1.27x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.748, Ratio=1.27x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.734, Ratio=1.25x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.723, Ratio=1.23x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.741, Ratio=1.25x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.749, Ratio=1.24x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.743, Ratio=1.26x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.752, Ratio=1.26x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.734, Ratio=1.26x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.747, Ratio=1.27x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.740, Ratio=1.25x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.724, Ratio=1.24x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.750, Ratio=1.27x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.746, Ratio=1.25x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.752, Ratio=1.26x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.749, Ratio=1.27x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.717, Ratio=1.24x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.729, Ratio=1.25x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.752, Ratio=1.27x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.738, Ratio=1.23x, Gap=-3.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.738, Ratio=1.27x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.747, Ratio=1.25x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.729, Ratio=1.25x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.738, Ratio=1.24x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.733, Ratio=1.27x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.733, Ratio=1.25x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.735, Ratio=1.25x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.742, Ratio=1.28x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.730, Ratio=1.24x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.744, Ratio=1.26x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.732, Ratio=1.25x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.741, Ratio=1.25x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.739, Ratio=1.24x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.739, Ratio=1.28x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.737, Ratio=1.25x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.749, Ratio=1.27x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.730, Ratio=1.24x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.742, Ratio=1.25x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.733, Ratio=1.25x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.761, Ratio=1.26x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.737, Ratio=1.25x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.722, Ratio=1.23x, Gap=-3.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.741, Ratio=1.26x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.735, Ratio=1.23x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.739, Ratio=1.25x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.739, Ratio=1.25x, Gap=-3.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.743, Ratio=1.26x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.745, Ratio=1.26x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.727, Ratio=1.25x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.750, Ratio=1.25x, Gap=-3.148

============================================================
Epoch 2/20 completed in 32.1s
Train: Loss=1.8929 (C:1.8929, R:0.0000) Ratio=2.18x
Val:   Loss=1.8757 (C:1.8757, R:0.0000) Ratio=2.53x
‚úÖ New best model saved (Val Loss: 1.8757)
============================================================

Epoch 3 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.747, Ratio=1.24x, Gap=-3.523
Batch   0/537: Loss=1.8846 (C:1.8846, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.740, Ratio=1.25x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.749, Ratio=1.26x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.735, Ratio=1.23x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.743, Ratio=1.24x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.755, Ratio=1.26x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.751, Ratio=1.25x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.755, Ratio=1.23x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.754, Ratio=1.24x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.769, Ratio=1.25x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.769, Ratio=1.23x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.750, Ratio=1.24x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.755, Ratio=1.23x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.750, Ratio=1.26x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.740, Ratio=1.23x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.754, Ratio=1.26x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.761, Ratio=1.25x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.751, Ratio=1.25x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.753, Ratio=1.26x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.739, Ratio=1.25x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.735, Ratio=1.23x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.744, Ratio=1.24x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.730, Ratio=1.22x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.751, Ratio=1.22x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.764, Ratio=1.23x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.760, Ratio=1.23x, Gap=-3.313
Batch  25/537: Loss=1.8869 (C:1.8869, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.766, Ratio=1.24x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.751, Ratio=1.22x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.747, Ratio=1.23x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.757, Ratio=1.24x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.730, Ratio=1.24x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.744, Ratio=1.23x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.714, Ratio=1.22x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.735, Ratio=1.23x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.725, Ratio=1.24x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.763, Ratio=1.25x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.737, Ratio=1.22x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.746, Ratio=1.22x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.740, Ratio=1.24x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.763, Ratio=1.25x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.760, Ratio=1.25x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.762, Ratio=1.24x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.751, Ratio=1.26x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.756, Ratio=1.23x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.737, Ratio=1.24x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.753, Ratio=1.23x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.741, Ratio=1.22x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.771, Ratio=1.27x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.786, Ratio=1.27x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.776, Ratio=1.25x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.768, Ratio=1.24x, Gap=-3.725
Batch  50/537: Loss=1.8847 (C:1.8847, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.763, Ratio=1.24x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.751, Ratio=1.23x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.765, Ratio=1.23x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.773, Ratio=1.24x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.765, Ratio=1.24x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.760, Ratio=1.23x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.776, Ratio=1.25x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.767, Ratio=1.23x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.755, Ratio=1.23x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.758, Ratio=1.24x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.748, Ratio=1.26x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.766, Ratio=1.22x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.778, Ratio=1.26x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.747, Ratio=1.24x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.744, Ratio=1.22x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.768, Ratio=1.26x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.740, Ratio=1.25x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.751, Ratio=1.26x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.755, Ratio=1.25x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.760, Ratio=1.25x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.762, Ratio=1.24x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.772, Ratio=1.25x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.758, Ratio=1.24x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.751, Ratio=1.25x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.773, Ratio=1.24x, Gap=-3.301
Batch  75/537: Loss=1.8824 (C:1.8824, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.766, Ratio=1.24x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.770, Ratio=1.25x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.747, Ratio=1.22x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.767, Ratio=1.23x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.761, Ratio=1.24x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.762, Ratio=1.24x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.767, Ratio=1.25x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.750, Ratio=1.23x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.744, Ratio=1.24x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.758, Ratio=1.23x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.756, Ratio=1.23x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.751, Ratio=1.24x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.742, Ratio=1.24x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.755, Ratio=1.24x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.756, Ratio=1.22x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.759, Ratio=1.24x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.747, Ratio=1.24x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.769, Ratio=1.23x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.763, Ratio=1.22x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.741, Ratio=1.25x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.754, Ratio=1.25x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.763, Ratio=1.26x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.761, Ratio=1.25x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.739, Ratio=1.21x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.751, Ratio=1.23x, Gap=-3.573
Batch 100/537: Loss=1.8864 (C:1.8864, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.768, Ratio=1.25x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.762, Ratio=1.24x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.750, Ratio=1.23x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.762, Ratio=1.24x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.766, Ratio=1.24x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.771, Ratio=1.24x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.769, Ratio=1.25x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.773, Ratio=1.25x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.763, Ratio=1.23x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.753, Ratio=1.23x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.770, Ratio=1.26x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.756, Ratio=1.25x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.739, Ratio=1.25x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.733, Ratio=1.24x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.730, Ratio=1.24x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.747, Ratio=1.24x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.746, Ratio=1.26x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.736, Ratio=1.23x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.723, Ratio=1.23x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.746, Ratio=1.23x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.753, Ratio=1.24x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.761, Ratio=1.25x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.744, Ratio=1.23x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.759, Ratio=1.24x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.763, Ratio=1.24x, Gap=-3.249
Batch 125/537: Loss=1.8813 (C:1.8813, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.769, Ratio=1.24x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.766, Ratio=1.26x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.768, Ratio=1.25x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.759, Ratio=1.26x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.766, Ratio=1.25x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.778, Ratio=1.26x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.775, Ratio=1.24x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.763, Ratio=1.25x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.771, Ratio=1.26x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.767, Ratio=1.25x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.787, Ratio=1.27x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.760, Ratio=1.25x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.756, Ratio=1.24x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.762, Ratio=1.23x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.759, Ratio=1.27x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.766, Ratio=1.27x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.771, Ratio=1.25x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.749, Ratio=1.23x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.749, Ratio=1.23x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.757, Ratio=1.24x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.774, Ratio=1.24x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.757, Ratio=1.25x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.746, Ratio=1.23x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.769, Ratio=1.26x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.789, Ratio=1.27x, Gap=-3.331
Batch 150/537: Loss=1.8681 (C:1.8681, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.773, Ratio=1.25x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.761, Ratio=1.25x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.773, Ratio=1.24x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.762, Ratio=1.24x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.752, Ratio=1.25x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.753, Ratio=1.24x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.766, Ratio=1.24x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.754, Ratio=1.23x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.741, Ratio=1.24x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.750, Ratio=1.24x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.720, Ratio=1.23x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.728, Ratio=1.22x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.720, Ratio=1.23x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.731, Ratio=1.24x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.731, Ratio=1.23x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.728, Ratio=1.24x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.751, Ratio=1.26x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.746, Ratio=1.24x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.753, Ratio=1.26x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.765, Ratio=1.25x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.763, Ratio=1.23x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.774, Ratio=1.26x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.765, Ratio=1.25x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.775, Ratio=1.25x, Gap=-3.929
Batch 175/537: Loss=1.8784 (C:1.8784, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=0.776, Ratio=1.23x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=0.786, Ratio=1.25x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.772, Ratio=1.24x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.777, Ratio=1.25x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.767, Ratio=1.24x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.764, Ratio=1.26x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.774, Ratio=1.24x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.764, Ratio=1.23x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.743, Ratio=1.22x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.751, Ratio=1.24x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.752, Ratio=1.25x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.750, Ratio=1.25x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.735, Ratio=1.22x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.746, Ratio=1.24x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.733, Ratio=1.23x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.748, Ratio=1.23x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.738, Ratio=1.25x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.739, Ratio=1.24x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.744, Ratio=1.24x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.752, Ratio=1.25x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.747, Ratio=1.24x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.769, Ratio=1.25x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.765, Ratio=1.24x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.775, Ratio=1.25x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.790, Ratio=1.25x, Gap=-3.384
Batch 200/537: Loss=1.8774 (C:1.8774, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.781, Ratio=1.24x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=0.795, Ratio=1.24x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.764, Ratio=1.24x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.782, Ratio=1.25x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.761, Ratio=1.26x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.764, Ratio=1.23x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.761, Ratio=1.23x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.763, Ratio=1.25x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.782, Ratio=1.24x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.749, Ratio=1.23x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.730, Ratio=1.25x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.743, Ratio=1.23x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.736, Ratio=1.25x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.736, Ratio=1.24x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.720, Ratio=1.22x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.743, Ratio=1.24x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.747, Ratio=1.25x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.752, Ratio=1.26x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.730, Ratio=1.24x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.731, Ratio=1.24x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.752, Ratio=1.24x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.747, Ratio=1.23x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.746, Ratio=1.22x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.762, Ratio=1.27x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.745, Ratio=1.23x, Gap=-3.532
Batch 225/537: Loss=1.8920 (C:1.8920, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.782, Ratio=1.25x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.772, Ratio=1.24x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=0.779, Ratio=1.24x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.777, Ratio=1.28x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.785, Ratio=1.26x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=0.787, Ratio=1.24x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=0.792, Ratio=1.24x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.770, Ratio=1.23x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.786, Ratio=1.25x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.779, Ratio=1.26x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.759, Ratio=1.23x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.761, Ratio=1.23x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.768, Ratio=1.26x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.773, Ratio=1.25x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.743, Ratio=1.25x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.766, Ratio=1.25x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.775, Ratio=1.25x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.741, Ratio=1.22x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.775, Ratio=1.26x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.767, Ratio=1.24x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.764, Ratio=1.22x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.775, Ratio=1.26x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.751, Ratio=1.24x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.765, Ratio=1.23x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.765, Ratio=1.24x, Gap=-3.654
Batch 250/537: Loss=1.8852 (C:1.8852, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.770, Ratio=1.22x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.749, Ratio=1.25x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.769, Ratio=1.24x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.774, Ratio=1.22x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.758, Ratio=1.24x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.773, Ratio=1.24x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.772, Ratio=1.24x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.768, Ratio=1.26x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.745, Ratio=1.24x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.760, Ratio=1.25x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.761, Ratio=1.24x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.754, Ratio=1.25x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.745, Ratio=1.23x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.754, Ratio=1.27x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.764, Ratio=1.27x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.746, Ratio=1.24x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.758, Ratio=1.24x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.755, Ratio=1.24x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.747, Ratio=1.23x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.749, Ratio=1.24x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.746, Ratio=1.22x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.746, Ratio=1.24x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.757, Ratio=1.25x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.764, Ratio=1.25x, Gap=-3.333
Batch 275/537: Loss=1.8798 (C:1.8798, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.761, Ratio=1.24x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.759, Ratio=1.25x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.779, Ratio=1.23x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.769, Ratio=1.25x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.764, Ratio=1.24x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.762, Ratio=1.25x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.773, Ratio=1.26x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.772, Ratio=1.26x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.764, Ratio=1.25x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.776, Ratio=1.27x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.753, Ratio=1.24x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.770, Ratio=1.27x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.769, Ratio=1.26x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.761, Ratio=1.24x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.741, Ratio=1.24x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.760, Ratio=1.23x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.749, Ratio=1.22x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.755, Ratio=1.24x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.770, Ratio=1.26x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.757, Ratio=1.24x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.769, Ratio=1.24x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.769, Ratio=1.24x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.758, Ratio=1.25x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.774, Ratio=1.23x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.760, Ratio=1.25x, Gap=-3.519
Batch 300/537: Loss=1.8771 (C:1.8771, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.762, Ratio=1.24x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.759, Ratio=1.24x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.765, Ratio=1.25x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.767, Ratio=1.25x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.768, Ratio=1.25x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.768, Ratio=1.24x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.773, Ratio=1.27x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.790, Ratio=1.27x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.772, Ratio=1.24x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.772, Ratio=1.25x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.771, Ratio=1.24x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.781, Ratio=1.24x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=0.779, Ratio=1.23x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.774, Ratio=1.26x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.753, Ratio=1.22x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.760, Ratio=1.25x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.752, Ratio=1.24x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.752, Ratio=1.24x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.750, Ratio=1.25x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.762, Ratio=1.28x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.743, Ratio=1.27x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.743, Ratio=1.23x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.744, Ratio=1.24x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.746, Ratio=1.26x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.733, Ratio=1.24x, Gap=-3.571
Batch 325/537: Loss=1.8865 (C:1.8865, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.745, Ratio=1.25x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.749, Ratio=1.25x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.741, Ratio=1.23x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.744, Ratio=1.25x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.755, Ratio=1.24x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.757, Ratio=1.24x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.762, Ratio=1.25x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.767, Ratio=1.22x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.738, Ratio=1.25x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.755, Ratio=1.25x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.754, Ratio=1.25x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.764, Ratio=1.24x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.778, Ratio=1.26x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.766, Ratio=1.26x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.758, Ratio=1.23x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.782, Ratio=1.25x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=0.804, Ratio=1.26x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=0.790, Ratio=1.23x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=0.786, Ratio=1.23x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.773, Ratio=1.23x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.783, Ratio=1.24x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=0.788, Ratio=1.23x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=0.777, Ratio=1.24x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.779, Ratio=1.25x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.766, Ratio=1.24x, Gap=-3.777
Batch 350/537: Loss=1.8819 (C:1.8819, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.776, Ratio=1.25x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.768, Ratio=1.23x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.769, Ratio=1.25x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.752, Ratio=1.22x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.746, Ratio=1.22x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.743, Ratio=1.24x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.744, Ratio=1.25x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.746, Ratio=1.26x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.723, Ratio=1.24x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.742, Ratio=1.24x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.731, Ratio=1.23x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.729, Ratio=1.24x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.728, Ratio=1.25x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.755, Ratio=1.24x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.737, Ratio=1.23x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.748, Ratio=1.27x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.759, Ratio=1.25x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.777, Ratio=1.27x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.776, Ratio=1.26x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.768, Ratio=1.25x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.759, Ratio=1.24x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.781, Ratio=1.27x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=0.783, Ratio=1.23x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.778, Ratio=1.24x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.764, Ratio=1.24x, Gap=-3.674
Batch 375/537: Loss=1.8811 (C:1.8811, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.770, Ratio=1.25x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.758, Ratio=1.24x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.765, Ratio=1.25x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.766, Ratio=1.25x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.759, Ratio=1.25x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.759, Ratio=1.25x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.761, Ratio=1.24x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.749, Ratio=1.23x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.775, Ratio=1.27x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.748, Ratio=1.23x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.747, Ratio=1.22x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.751, Ratio=1.25x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.749, Ratio=1.25x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.755, Ratio=1.24x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.750, Ratio=1.26x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.752, Ratio=1.24x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.756, Ratio=1.24x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.774, Ratio=1.23x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.765, Ratio=1.26x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.771, Ratio=1.25x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.756, Ratio=1.26x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.770, Ratio=1.26x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.766, Ratio=1.25x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.757, Ratio=1.22x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.771, Ratio=1.26x, Gap=-3.440
Batch 400/537: Loss=1.8749 (C:1.8749, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.764, Ratio=1.24x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=0.782, Ratio=1.24x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.770, Ratio=1.23x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.747, Ratio=1.24x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.765, Ratio=1.25x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.768, Ratio=1.24x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.756, Ratio=1.24x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.766, Ratio=1.25x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.767, Ratio=1.24x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.762, Ratio=1.27x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.773, Ratio=1.25x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.774, Ratio=1.26x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.743, Ratio=1.23x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.751, Ratio=1.24x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.753, Ratio=1.24x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.762, Ratio=1.25x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.744, Ratio=1.25x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.762, Ratio=1.24x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.755, Ratio=1.25x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.765, Ratio=1.25x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.744, Ratio=1.23x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.765, Ratio=1.25x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.762, Ratio=1.24x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.757, Ratio=1.26x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.763, Ratio=1.25x, Gap=-3.331
Batch 425/537: Loss=1.8770 (C:1.8770, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.753, Ratio=1.23x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.761, Ratio=1.25x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.735, Ratio=1.24x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.759, Ratio=1.25x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.783, Ratio=1.28x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.780, Ratio=1.25x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.760, Ratio=1.24x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.739, Ratio=1.23x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.759, Ratio=1.23x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.769, Ratio=1.26x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.764, Ratio=1.24x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.763, Ratio=1.24x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.754, Ratio=1.24x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.760, Ratio=1.24x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.764, Ratio=1.24x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.778, Ratio=1.26x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.769, Ratio=1.24x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.770, Ratio=1.25x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.759, Ratio=1.25x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.764, Ratio=1.24x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.739, Ratio=1.24x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.762, Ratio=1.26x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.751, Ratio=1.24x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.744, Ratio=1.24x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.763, Ratio=1.25x, Gap=-3.321
Batch 450/537: Loss=1.8764 (C:1.8764, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.753, Ratio=1.24x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.752, Ratio=1.23x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.770, Ratio=1.26x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.778, Ratio=1.24x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.766, Ratio=1.26x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.779, Ratio=1.25x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.785, Ratio=1.28x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.770, Ratio=1.25x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.780, Ratio=1.25x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.768, Ratio=1.25x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.759, Ratio=1.24x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.761, Ratio=1.24x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.744, Ratio=1.24x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.757, Ratio=1.26x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=0.787, Ratio=1.24x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.739, Ratio=1.23x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.757, Ratio=1.28x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.749, Ratio=1.23x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.738, Ratio=1.24x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.754, Ratio=1.28x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.746, Ratio=1.25x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.771, Ratio=1.26x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.753, Ratio=1.24x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.767, Ratio=1.26x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.773, Ratio=1.26x, Gap=-3.644
Batch 475/537: Loss=1.8711 (C:1.8711, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.763, Ratio=1.23x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.750, Ratio=1.22x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.764, Ratio=1.25x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.767, Ratio=1.25x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.761, Ratio=1.26x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.762, Ratio=1.25x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.761, Ratio=1.24x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.792, Ratio=1.27x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.778, Ratio=1.27x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.786, Ratio=1.26x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.770, Ratio=1.26x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=0.788, Ratio=1.25x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.775, Ratio=1.25x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.763, Ratio=1.23x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.772, Ratio=1.24x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.783, Ratio=1.26x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.777, Ratio=1.25x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=0.787, Ratio=1.22x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=0.771, Ratio=1.21x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.773, Ratio=1.26x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.771, Ratio=1.23x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.774, Ratio=1.25x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.767, Ratio=1.25x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.759, Ratio=1.25x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.773, Ratio=1.26x, Gap=-3.461
Batch 500/537: Loss=1.8707 (C:1.8707, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.757, Ratio=1.25x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.751, Ratio=1.24x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.750, Ratio=1.23x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.741, Ratio=1.24x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.764, Ratio=1.25x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.768, Ratio=1.24x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.759, Ratio=1.26x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.765, Ratio=1.25x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.748, Ratio=1.24x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.749, Ratio=1.24x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.737, Ratio=1.23x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.743, Ratio=1.27x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.749, Ratio=1.25x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.748, Ratio=1.25x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.754, Ratio=1.30x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.761, Ratio=1.26x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.785, Ratio=1.26x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.762, Ratio=1.25x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.773, Ratio=1.26x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.776, Ratio=1.24x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=0.773, Ratio=1.23x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.782, Ratio=1.25x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.766, Ratio=1.24x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.780, Ratio=1.25x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.769, Ratio=1.23x, Gap=-3.980
Batch 525/537: Loss=1.8894 (C:1.8894, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=0.784, Ratio=1.24x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.766, Ratio=1.26x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.791, Ratio=1.28x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.782, Ratio=1.24x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.770, Ratio=1.24x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.769, Ratio=1.26x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.759, Ratio=1.26x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.761, Ratio=1.23x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.765, Ratio=1.26x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.754, Ratio=1.25x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.761, Ratio=1.26x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.767, Ratio=1.27x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.760, Ratio=1.27x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.775, Ratio=1.27x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.760, Ratio=1.27x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.767, Ratio=1.27x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.768, Ratio=1.28x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.780, Ratio=1.28x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.756, Ratio=1.26x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.784, Ratio=1.29x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.759, Ratio=1.26x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.759, Ratio=1.28x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.767, Ratio=1.30x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.765, Ratio=1.27x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.767, Ratio=1.27x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.754, Ratio=1.26x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.768, Ratio=1.27x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.763, Ratio=1.27x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.777, Ratio=1.27x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.770, Ratio=1.26x, Gap=-3.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.763, Ratio=1.25x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.764, Ratio=1.27x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.761, Ratio=1.27x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.761, Ratio=1.27x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.780, Ratio=1.28x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.762, Ratio=1.25x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.774, Ratio=1.27x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.763, Ratio=1.29x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.778, Ratio=1.28x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.767, Ratio=1.30x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.771, Ratio=1.27x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.769, Ratio=1.29x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.751, Ratio=1.27x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.773, Ratio=1.29x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.781, Ratio=1.27x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.775, Ratio=1.27x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.767, Ratio=1.29x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.766, Ratio=1.28x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.761, Ratio=1.29x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.772, Ratio=1.27x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.767, Ratio=1.25x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.751, Ratio=1.26x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.759, Ratio=1.27x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.785, Ratio=1.28x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.767, Ratio=1.27x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.768, Ratio=1.25x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.757, Ratio=1.27x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.780, Ratio=1.30x, Gap=-3.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.760, Ratio=1.26x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.769, Ratio=1.28x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.759, Ratio=1.27x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.758, Ratio=1.26x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.766, Ratio=1.27x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.753, Ratio=1.28x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.766, Ratio=1.27x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.767, Ratio=1.26x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.777, Ratio=1.28x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.777, Ratio=1.27x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.756, Ratio=1.26x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.778, Ratio=1.28x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.778, Ratio=1.28x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.764, Ratio=1.27x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.766, Ratio=1.27x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.773, Ratio=1.29x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.771, Ratio=1.29x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.751, Ratio=1.27x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.761, Ratio=1.28x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.789, Ratio=1.29x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.769, Ratio=1.27x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.768, Ratio=1.28x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.763, Ratio=1.28x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.768, Ratio=1.28x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.754, Ratio=1.28x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.778, Ratio=1.29x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.765, Ratio=1.27x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.763, Ratio=1.27x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.784, Ratio=1.29x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.755, Ratio=1.29x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.765, Ratio=1.29x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.784, Ratio=1.28x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.763, Ratio=1.26x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.767, Ratio=1.26x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.773, Ratio=1.29x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.768, Ratio=1.29x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.784, Ratio=1.28x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.773, Ratio=1.28x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.752, Ratio=1.27x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.775, Ratio=1.28x, Gap=-3.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.769, Ratio=1.28x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.768, Ratio=1.29x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.774, Ratio=1.29x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.761, Ratio=1.26x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.779, Ratio=1.28x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.758, Ratio=1.27x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.761, Ratio=1.29x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.770, Ratio=1.27x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.770, Ratio=1.29x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.765, Ratio=1.26x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.764, Ratio=1.27x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.778, Ratio=1.27x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.769, Ratio=1.28x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.777, Ratio=1.28x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.768, Ratio=1.27x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.763, Ratio=1.26x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.760, Ratio=1.28x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.768, Ratio=1.27x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.767, Ratio=1.28x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.750, Ratio=1.25x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.743, Ratio=1.26x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.759, Ratio=1.27x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.756, Ratio=1.27x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.772, Ratio=1.27x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.760, Ratio=1.26x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.776, Ratio=1.28x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.778, Ratio=1.29x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.757, Ratio=1.25x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.768, Ratio=1.27x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.760, Ratio=1.28x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.747, Ratio=1.28x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.756, Ratio=1.28x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.771, Ratio=1.28x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.770, Ratio=1.26x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.759, Ratio=1.28x, Gap=-3.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.772, Ratio=1.27x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.778, Ratio=1.28x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.778, Ratio=1.30x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.763, Ratio=1.28x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.752, Ratio=1.26x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.763, Ratio=1.28x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.750, Ratio=1.25x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.767, Ratio=1.27x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.764, Ratio=1.27x, Gap=-3.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.756, Ratio=1.24x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.773, Ratio=1.29x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.769, Ratio=1.29x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.767, Ratio=1.27x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.765, Ratio=1.29x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.768, Ratio=1.27x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.766, Ratio=1.28x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.771, Ratio=1.27x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.777, Ratio=1.27x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.782, Ratio=1.29x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.770, Ratio=1.26x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.778, Ratio=1.29x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.775, Ratio=1.26x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.777, Ratio=1.29x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.779, Ratio=1.30x, Gap=-3.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.770, Ratio=1.28x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.766, Ratio=1.28x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.777, Ratio=1.28x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.761, Ratio=1.28x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.766, Ratio=1.28x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.739, Ratio=1.26x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.765, Ratio=1.28x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.760, Ratio=1.28x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.770, Ratio=1.28x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.774, Ratio=1.29x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.766, Ratio=1.28x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.774, Ratio=1.25x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.764, Ratio=1.28x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.751, Ratio=1.26x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.766, Ratio=1.28x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.762, Ratio=1.27x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.778, Ratio=1.30x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.763, Ratio=1.26x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.750, Ratio=1.27x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.755, Ratio=1.27x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.756, Ratio=1.29x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.756, Ratio=1.28x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.779, Ratio=1.26x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.758, Ratio=1.27x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.763, Ratio=1.28x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.759, Ratio=1.27x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.776, Ratio=1.28x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.777, Ratio=1.28x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.777, Ratio=1.28x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.767, Ratio=1.27x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.771, Ratio=1.28x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.754, Ratio=1.27x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.763, Ratio=1.27x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.766, Ratio=1.26x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.755, Ratio=1.28x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.766, Ratio=1.27x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.776, Ratio=1.28x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.764, Ratio=1.28x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.765, Ratio=1.27x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.768, Ratio=1.28x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.754, Ratio=1.27x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.781, Ratio=1.31x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.777, Ratio=1.28x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.761, Ratio=1.26x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.757, Ratio=1.26x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.767, Ratio=1.28x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.774, Ratio=1.28x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.771, Ratio=1.26x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.768, Ratio=1.28x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.772, Ratio=1.26x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.788, Ratio=1.27x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.758, Ratio=1.27x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.754, Ratio=1.28x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.774, Ratio=1.26x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.772, Ratio=1.26x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.771, Ratio=1.30x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.752, Ratio=1.26x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.765, Ratio=1.26x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.758, Ratio=1.27x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.769, Ratio=1.29x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.765, Ratio=1.28x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.770, Ratio=1.29x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.765, Ratio=1.28x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.753, Ratio=1.27x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.761, Ratio=1.26x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.767, Ratio=1.27x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.758, Ratio=1.27x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.773, Ratio=1.27x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.766, Ratio=1.28x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.763, Ratio=1.27x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.763, Ratio=1.29x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.771, Ratio=1.28x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.760, Ratio=1.27x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.753, Ratio=1.28x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.770, Ratio=1.29x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.787, Ratio=1.28x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.762, Ratio=1.27x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.774, Ratio=1.26x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.782, Ratio=1.27x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.783, Ratio=1.31x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.754, Ratio=1.26x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.767, Ratio=1.27x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.742, Ratio=1.25x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.773, Ratio=1.28x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.778, Ratio=1.29x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.775, Ratio=1.27x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.755, Ratio=1.26x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.781, Ratio=1.25x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.761, Ratio=1.28x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.771, Ratio=1.28x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.788, Ratio=1.28x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.777, Ratio=1.29x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.769, Ratio=1.30x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.775, Ratio=1.27x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.759, Ratio=1.28x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.760, Ratio=1.28x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.766, Ratio=1.27x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.746, Ratio=1.27x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.765, Ratio=1.29x, Gap=-3.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.774, Ratio=1.27x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.773, Ratio=1.26x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.768, Ratio=1.26x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.771, Ratio=1.27x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.762, Ratio=1.30x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.762, Ratio=1.27x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.779, Ratio=1.30x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.772, Ratio=1.28x, Gap=-3.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.774, Ratio=1.28x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.764, Ratio=1.29x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.755, Ratio=1.29x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.770, Ratio=1.28x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.769, Ratio=1.29x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.773, Ratio=1.28x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.765, Ratio=1.26x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.785, Ratio=1.30x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.758, Ratio=1.26x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.756, Ratio=1.28x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.762, Ratio=1.27x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.766, Ratio=1.27x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.775, Ratio=1.28x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.785, Ratio=1.28x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.767, Ratio=1.28x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.770, Ratio=1.27x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.771, Ratio=1.28x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.765, Ratio=1.27x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.771, Ratio=1.25x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.770, Ratio=1.27x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.768, Ratio=1.26x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.749, Ratio=1.28x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.776, Ratio=1.29x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.763, Ratio=1.26x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.770, Ratio=1.29x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.774, Ratio=1.29x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.764, Ratio=1.26x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.767, Ratio=1.27x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.767, Ratio=1.27x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.757, Ratio=1.26x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.769, Ratio=1.29x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.763, Ratio=1.27x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.764, Ratio=1.27x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.769, Ratio=1.28x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.764, Ratio=1.27x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.762, Ratio=1.28x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.765, Ratio=1.26x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.748, Ratio=1.27x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.766, Ratio=1.28x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.771, Ratio=1.28x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.768, Ratio=1.26x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.757, Ratio=1.28x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.766, Ratio=1.27x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.740, Ratio=1.26x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.773, Ratio=1.28x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.770, Ratio=1.30x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.763, Ratio=1.28x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.748, Ratio=1.26x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.783, Ratio=1.30x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.748, Ratio=1.26x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.765, Ratio=1.27x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.750, Ratio=1.27x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.773, Ratio=1.28x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.763, Ratio=1.27x, Gap=-3.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.766, Ratio=1.26x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.766, Ratio=1.28x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.756, Ratio=1.27x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.770, Ratio=1.26x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.755, Ratio=1.29x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.758, Ratio=1.26x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.762, Ratio=1.28x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.761, Ratio=1.27x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.774, Ratio=1.30x, Gap=-3.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.769, Ratio=1.28x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.757, Ratio=1.27x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.753, Ratio=1.27x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.773, Ratio=1.26x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.776, Ratio=1.27x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.773, Ratio=1.28x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.760, Ratio=1.30x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.783, Ratio=1.28x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.780, Ratio=1.27x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.757, Ratio=1.25x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.768, Ratio=1.28x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.757, Ratio=1.26x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.740, Ratio=1.25x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.755, Ratio=1.28x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.752, Ratio=1.26x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.766, Ratio=1.27x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.764, Ratio=1.29x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.766, Ratio=1.28x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.744, Ratio=1.27x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.770, Ratio=1.29x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.769, Ratio=1.28x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.769, Ratio=1.27x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.791, Ratio=1.32x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.765, Ratio=1.25x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.769, Ratio=1.26x, Gap=-3.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.777, Ratio=1.28x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.767, Ratio=1.28x, Gap=-3.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.769, Ratio=1.26x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.764, Ratio=1.27x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.770, Ratio=1.28x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.761, Ratio=1.27x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.779, Ratio=1.28x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.771, Ratio=1.29x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.754, Ratio=1.26x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.755, Ratio=1.26x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.757, Ratio=1.26x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.770, Ratio=1.27x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.763, Ratio=1.27x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.770, Ratio=1.29x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.765, Ratio=1.27x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.757, Ratio=1.29x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.770, Ratio=1.26x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.757, Ratio=1.28x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.760, Ratio=1.26x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.765, Ratio=1.28x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.754, Ratio=1.27x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.770, Ratio=1.27x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.769, Ratio=1.29x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.766, Ratio=1.29x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.770, Ratio=1.30x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.767, Ratio=1.27x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.759, Ratio=1.28x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.752, Ratio=1.27x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.771, Ratio=1.27x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.755, Ratio=1.27x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.754, Ratio=1.27x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.763, Ratio=1.26x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.771, Ratio=1.28x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.768, Ratio=1.27x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.766, Ratio=1.28x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.761, Ratio=1.28x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.779, Ratio=1.27x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.776, Ratio=1.29x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.759, Ratio=1.28x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.771, Ratio=1.28x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.759, Ratio=1.28x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.776, Ratio=1.28x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.755, Ratio=1.29x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.778, Ratio=1.27x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.761, Ratio=1.26x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.768, Ratio=1.27x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.763, Ratio=1.26x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.760, Ratio=1.26x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.752, Ratio=1.26x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.764, Ratio=1.29x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.762, Ratio=1.29x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.773, Ratio=1.28x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.758, Ratio=1.26x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.764, Ratio=1.28x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.764, Ratio=1.27x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.767, Ratio=1.30x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.757, Ratio=1.28x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.772, Ratio=1.28x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.767, Ratio=1.27x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.759, Ratio=1.27x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.765, Ratio=1.28x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.753, Ratio=1.27x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.751, Ratio=1.28x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.762, Ratio=1.26x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.769, Ratio=1.28x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.762, Ratio=1.27x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.765, Ratio=1.27x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.776, Ratio=1.25x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.766, Ratio=1.26x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.759, Ratio=1.28x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.760, Ratio=1.26x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.763, Ratio=1.27x, Gap=-3.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.770, Ratio=1.31x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.775, Ratio=1.28x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.760, Ratio=1.26x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.754, Ratio=1.29x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.762, Ratio=1.28x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.767, Ratio=1.27x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.771, Ratio=1.28x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.768, Ratio=1.28x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.773, Ratio=1.30x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.760, Ratio=1.26x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.779, Ratio=1.28x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.775, Ratio=1.27x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.769, Ratio=1.27x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.772, Ratio=1.28x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.765, Ratio=1.26x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.765, Ratio=1.29x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.761, Ratio=1.25x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.764, Ratio=1.27x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.773, Ratio=1.30x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.767, Ratio=1.29x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.769, Ratio=1.28x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.769, Ratio=1.28x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.762, Ratio=1.28x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.775, Ratio=1.29x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.753, Ratio=1.28x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.763, Ratio=1.28x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.781, Ratio=1.29x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.779, Ratio=1.30x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.769, Ratio=1.30x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.770, Ratio=1.27x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.782, Ratio=1.27x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.777, Ratio=1.29x, Gap=-3.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.771, Ratio=1.27x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.769, Ratio=1.28x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.771, Ratio=1.29x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.770, Ratio=1.28x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.767, Ratio=1.26x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.764, Ratio=1.28x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.770, Ratio=1.27x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.752, Ratio=1.28x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.772, Ratio=1.27x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.779, Ratio=1.28x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.787, Ratio=1.29x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.750, Ratio=1.27x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.769, Ratio=1.28x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.774, Ratio=1.30x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.766, Ratio=1.26x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.761, Ratio=1.30x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.756, Ratio=1.29x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.754, Ratio=1.25x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.767, Ratio=1.27x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.779, Ratio=1.27x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.778, Ratio=1.29x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.751, Ratio=1.26x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.769, Ratio=1.25x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.775, Ratio=1.26x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.769, Ratio=1.29x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.776, Ratio=1.28x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.771, Ratio=1.29x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.762, Ratio=1.25x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.758, Ratio=1.26x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.788, Ratio=1.31x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.773, Ratio=1.27x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.771, Ratio=1.28x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.762, Ratio=1.26x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.775, Ratio=1.30x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.774, Ratio=1.28x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.766, Ratio=1.27x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.754, Ratio=1.25x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.751, Ratio=1.27x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.765, Ratio=1.28x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.784, Ratio=1.30x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.769, Ratio=1.28x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.773, Ratio=1.26x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.774, Ratio=1.28x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.753, Ratio=1.25x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.771, Ratio=1.29x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.758, Ratio=1.27x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.761, Ratio=1.25x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.767, Ratio=1.26x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.760, Ratio=1.25x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.757, Ratio=1.29x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.774, Ratio=1.27x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.766, Ratio=1.27x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.760, Ratio=1.27x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.764, Ratio=1.26x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.762, Ratio=1.27x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.763, Ratio=1.27x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.771, Ratio=1.28x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.757, Ratio=1.27x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.772, Ratio=1.26x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.758, Ratio=1.26x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.767, Ratio=1.26x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.765, Ratio=1.27x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.771, Ratio=1.28x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.772, Ratio=1.29x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.752, Ratio=1.28x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.767, Ratio=1.27x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.744, Ratio=1.28x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.767, Ratio=1.27x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.773, Ratio=1.28x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.754, Ratio=1.26x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.771, Ratio=1.27x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.765, Ratio=1.29x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.759, Ratio=1.26x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.756, Ratio=1.28x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.758, Ratio=1.27x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.774, Ratio=1.28x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.770, Ratio=1.27x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.775, Ratio=1.28x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.772, Ratio=1.28x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.773, Ratio=1.27x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.778, Ratio=1.27x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.762, Ratio=1.28x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.776, Ratio=1.28x, Gap=-3.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.762, Ratio=1.27x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.768, Ratio=1.27x, Gap=-2.888

============================================================
Epoch 3/20 completed in 32.6s
Train: Loss=1.8813 (C:1.8813, R:0.0000) Ratio=2.40x
Val:   Loss=1.8657 (C:1.8657, R:0.0000) Ratio=2.74x
‚úÖ New best model saved (Val Loss: 1.8657)
============================================================

üåç Updating global dataset at epoch 4
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.570 ¬± 0.564
    Neg distances: 1.572 ¬± 0.862
    Separation ratio: 2.76x
    Gap: -3.559
    ‚úÖ Good global separation

Epoch 4 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.559, Ratio=2.58x, Gap=-3.534
Batch   0/537: Loss=1.2293 (C:1.2293, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.556, Ratio=2.56x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.587, Ratio=2.74x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.572, Ratio=2.60x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.573, Ratio=2.65x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.577, Ratio=2.56x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.575, Ratio=2.60x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.579, Ratio=2.66x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.595, Ratio=2.65x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.596, Ratio=2.68x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.596, Ratio=2.71x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.582, Ratio=2.57x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.588, Ratio=2.63x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.566, Ratio=2.55x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.591, Ratio=2.70x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.582, Ratio=2.68x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.593, Ratio=2.71x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.572, Ratio=2.62x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.576, Ratio=2.58x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.584, Ratio=2.72x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.589, Ratio=2.72x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.590, Ratio=2.74x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.598, Ratio=2.64x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.583, Ratio=2.70x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.588, Ratio=2.60x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.607, Ratio=2.74x, Gap=-3.726
Batch  25/537: Loss=1.1870 (C:1.1870, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.580, Ratio=2.61x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.609, Ratio=2.65x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.587, Ratio=2.71x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.613, Ratio=2.90x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.586, Ratio=2.68x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.573, Ratio=2.67x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.577, Ratio=2.61x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.575, Ratio=2.65x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.580, Ratio=2.52x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.604, Ratio=2.71x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.572, Ratio=2.55x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.563, Ratio=2.57x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.593, Ratio=2.69x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.613, Ratio=2.74x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.594, Ratio=2.68x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.624, Ratio=2.81x, Gap=-4.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.559, Ratio=2.60x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.564, Ratio=2.63x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.582, Ratio=2.68x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.581, Ratio=2.62x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.580, Ratio=2.58x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.597, Ratio=2.67x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.591, Ratio=2.63x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.581, Ratio=2.55x, Gap=-4.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.583, Ratio=2.63x, Gap=-3.532
Batch  50/537: Loss=1.2170 (C:1.2170, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.572, Ratio=2.61x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.569, Ratio=2.65x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.516, Ratio=2.37x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.580, Ratio=2.74x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.550, Ratio=2.54x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.596, Ratio=2.71x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.579, Ratio=2.60x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.586, Ratio=2.70x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.599, Ratio=2.67x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.597, Ratio=2.66x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.616, Ratio=2.75x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.574, Ratio=2.63x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.598, Ratio=2.71x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.577, Ratio=2.68x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.539, Ratio=2.48x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.573, Ratio=2.66x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.563, Ratio=2.60x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.586, Ratio=2.68x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.566, Ratio=2.58x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.602, Ratio=2.68x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.591, Ratio=2.64x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.601, Ratio=2.71x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.598, Ratio=2.60x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.588, Ratio=2.57x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.553, Ratio=2.52x, Gap=-3.748
Batch  75/537: Loss=1.2522 (C:1.2522, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.578, Ratio=2.61x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.581, Ratio=2.63x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.585, Ratio=2.69x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.586, Ratio=2.66x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.569, Ratio=2.57x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.590, Ratio=2.65x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.556, Ratio=2.50x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.582, Ratio=2.56x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.570, Ratio=2.60x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.556, Ratio=2.61x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.567, Ratio=2.61x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.577, Ratio=2.65x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.569, Ratio=2.50x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.575, Ratio=2.69x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.564, Ratio=2.63x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.594, Ratio=2.68x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.573, Ratio=2.56x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.564, Ratio=2.56x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.533, Ratio=2.49x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.579, Ratio=2.64x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.593, Ratio=2.69x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.568, Ratio=2.57x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.606, Ratio=2.72x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.605, Ratio=2.68x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.576, Ratio=2.61x, Gap=-3.607
Batch 100/537: Loss=1.2227 (C:1.2227, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.588, Ratio=2.65x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.560, Ratio=2.57x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.581, Ratio=2.60x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.599, Ratio=2.69x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.573, Ratio=2.58x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.569, Ratio=2.60x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.554, Ratio=2.41x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.592, Ratio=2.73x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.576, Ratio=2.53x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.599, Ratio=2.65x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.570, Ratio=2.55x, Gap=-4.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.613, Ratio=2.79x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.578, Ratio=2.60x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.566, Ratio=2.60x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.561, Ratio=2.56x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.567, Ratio=2.61x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.571, Ratio=2.61x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.584, Ratio=2.67x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.563, Ratio=2.50x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.575, Ratio=2.62x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.613, Ratio=2.77x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.592, Ratio=2.68x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.594, Ratio=2.65x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.574, Ratio=2.53x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.584, Ratio=2.66x, Gap=-3.576
Batch 125/537: Loss=1.2068 (C:1.2068, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.607, Ratio=2.62x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.573, Ratio=2.57x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.557, Ratio=2.52x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.569, Ratio=2.65x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.577, Ratio=2.59x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.581, Ratio=2.66x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.610, Ratio=2.77x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.588, Ratio=2.68x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.581, Ratio=2.63x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.582, Ratio=2.63x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.588, Ratio=2.66x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.581, Ratio=2.61x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.578, Ratio=2.65x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.591, Ratio=2.70x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.570, Ratio=2.59x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.577, Ratio=2.58x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.573, Ratio=2.66x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.591, Ratio=2.63x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.568, Ratio=2.60x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.578, Ratio=2.66x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.565, Ratio=2.58x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.562, Ratio=2.62x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.591, Ratio=2.72x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.588, Ratio=2.73x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.575, Ratio=2.68x, Gap=-3.739
Batch 150/537: Loss=1.2039 (C:1.2039, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.549, Ratio=2.61x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.563, Ratio=2.65x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.563, Ratio=2.57x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.587, Ratio=2.59x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.568, Ratio=2.62x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.590, Ratio=2.55x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.561, Ratio=2.57x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.595, Ratio=2.63x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.585, Ratio=2.63x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.581, Ratio=2.63x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.602, Ratio=2.78x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.566, Ratio=2.54x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.597, Ratio=2.70x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.572, Ratio=2.60x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.588, Ratio=2.66x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.591, Ratio=2.68x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.588, Ratio=2.64x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.580, Ratio=2.71x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.577, Ratio=2.61x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.592, Ratio=2.72x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.581, Ratio=2.68x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.586, Ratio=2.64x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.588, Ratio=2.61x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.604, Ratio=2.70x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.584, Ratio=2.63x, Gap=-3.638
Batch 175/537: Loss=1.2188 (C:1.2188, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.587, Ratio=2.59x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.597, Ratio=2.61x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.591, Ratio=2.72x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.604, Ratio=2.75x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.566, Ratio=2.58x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.591, Ratio=2.69x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.563, Ratio=2.68x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.570, Ratio=2.61x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.546, Ratio=2.48x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.560, Ratio=2.49x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.566, Ratio=2.63x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.570, Ratio=2.48x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.563, Ratio=2.58x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.578, Ratio=2.63x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.578, Ratio=2.58x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.578, Ratio=2.72x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.582, Ratio=2.66x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.567, Ratio=2.58x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.573, Ratio=2.59x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.575, Ratio=2.64x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.611, Ratio=2.66x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.596, Ratio=2.73x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.597, Ratio=2.62x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.602, Ratio=2.75x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.600, Ratio=2.70x, Gap=-3.694
Batch 200/537: Loss=1.1997 (C:1.1997, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.580, Ratio=2.69x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.560, Ratio=2.58x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.587, Ratio=2.71x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.588, Ratio=2.66x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.580, Ratio=2.63x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.561, Ratio=2.53x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.586, Ratio=2.62x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.583, Ratio=2.59x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.565, Ratio=2.58x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.608, Ratio=2.74x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.592, Ratio=2.69x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.629, Ratio=2.78x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.591, Ratio=2.74x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.588, Ratio=2.55x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.588, Ratio=2.63x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.568, Ratio=2.65x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.563, Ratio=2.53x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.579, Ratio=2.67x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.575, Ratio=2.61x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.576, Ratio=2.58x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.565, Ratio=2.65x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.579, Ratio=2.73x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.581, Ratio=2.70x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.572, Ratio=2.61x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.579, Ratio=2.69x, Gap=-3.351
Batch 225/537: Loss=1.2004 (C:1.2004, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.586, Ratio=2.69x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.572, Ratio=2.61x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.598, Ratio=2.70x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.582, Ratio=2.62x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.600, Ratio=2.65x, Gap=-4.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.591, Ratio=2.56x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.575, Ratio=2.57x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.561, Ratio=2.54x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.596, Ratio=2.65x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.581, Ratio=2.71x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.559, Ratio=2.60x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.601, Ratio=2.79x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.614, Ratio=2.89x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.589, Ratio=2.70x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.577, Ratio=2.64x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.559, Ratio=2.53x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.585, Ratio=2.71x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.599, Ratio=2.68x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.587, Ratio=2.64x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.555, Ratio=2.59x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.614, Ratio=2.78x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.580, Ratio=2.57x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.606, Ratio=2.75x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.583, Ratio=2.63x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.581, Ratio=2.70x, Gap=-3.631
Batch 250/537: Loss=1.2010 (C:1.2010, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.606, Ratio=2.76x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.586, Ratio=2.66x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.583, Ratio=2.69x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.557, Ratio=2.53x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.586, Ratio=2.72x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.597, Ratio=2.82x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.581, Ratio=2.64x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.588, Ratio=2.63x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.592, Ratio=2.68x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.608, Ratio=2.71x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.585, Ratio=2.63x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.588, Ratio=2.63x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.554, Ratio=2.53x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.570, Ratio=2.55x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.568, Ratio=2.59x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.578, Ratio=2.61x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.568, Ratio=2.56x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.589, Ratio=2.76x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.576, Ratio=2.61x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.563, Ratio=2.47x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.590, Ratio=2.60x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.589, Ratio=2.66x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.573, Ratio=2.57x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.570, Ratio=2.59x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.554, Ratio=2.49x, Gap=-4.159
Batch 275/537: Loss=1.2583 (C:1.2583, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.573, Ratio=2.61x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.569, Ratio=2.57x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.590, Ratio=2.69x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.553, Ratio=2.55x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.569, Ratio=2.60x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.550, Ratio=2.52x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.576, Ratio=2.72x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.576, Ratio=2.68x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.608, Ratio=2.78x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.596, Ratio=2.69x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.605, Ratio=2.62x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.570, Ratio=2.63x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.608, Ratio=2.73x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.610, Ratio=2.67x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.608, Ratio=2.62x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.624, Ratio=2.78x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.592, Ratio=2.65x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.574, Ratio=2.63x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.585, Ratio=2.64x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.570, Ratio=2.59x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.596, Ratio=2.75x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.552, Ratio=2.57x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.568, Ratio=2.68x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.579, Ratio=2.76x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.563, Ratio=2.55x, Gap=-3.573
Batch 300/537: Loss=1.2408 (C:1.2408, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.570, Ratio=2.71x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.564, Ratio=2.67x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.556, Ratio=2.53x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.580, Ratio=2.62x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.631, Ratio=2.83x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.591, Ratio=2.61x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.613, Ratio=2.81x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.601, Ratio=2.72x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.610, Ratio=2.81x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.606, Ratio=2.62x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.599, Ratio=2.66x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.573, Ratio=2.69x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.604, Ratio=2.71x, Gap=-4.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.579, Ratio=2.63x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.593, Ratio=2.67x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.581, Ratio=2.72x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.559, Ratio=2.65x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.563, Ratio=2.61x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.579, Ratio=2.64x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.569, Ratio=2.63x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.589, Ratio=2.65x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.605, Ratio=2.71x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.601, Ratio=2.75x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.575, Ratio=2.67x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.611, Ratio=2.73x, Gap=-3.762
Batch 325/537: Loss=1.1899 (C:1.1899, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.562, Ratio=2.56x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.561, Ratio=2.55x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.604, Ratio=2.61x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.574, Ratio=2.52x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.590, Ratio=2.56x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.601, Ratio=2.75x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.600, Ratio=2.73x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.575, Ratio=2.63x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.593, Ratio=2.72x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.580, Ratio=2.74x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.585, Ratio=2.70x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.569, Ratio=2.66x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.581, Ratio=2.72x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.573, Ratio=2.61x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.606, Ratio=2.67x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.594, Ratio=2.63x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.606, Ratio=2.59x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.577, Ratio=2.63x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.584, Ratio=2.60x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.593, Ratio=2.66x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.583, Ratio=2.74x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.571, Ratio=2.59x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.592, Ratio=2.81x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.586, Ratio=2.73x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.590, Ratio=2.69x, Gap=-3.391
Batch 350/537: Loss=1.1967 (C:1.1967, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.575, Ratio=2.58x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.592, Ratio=2.73x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.572, Ratio=2.65x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.587, Ratio=2.64x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.578, Ratio=2.63x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.595, Ratio=2.70x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.603, Ratio=2.78x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.578, Ratio=2.66x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.605, Ratio=2.74x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.593, Ratio=2.69x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.572, Ratio=2.59x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.594, Ratio=2.73x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.581, Ratio=2.66x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.573, Ratio=2.62x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.566, Ratio=2.55x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.595, Ratio=2.71x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.574, Ratio=2.65x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.577, Ratio=2.59x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.592, Ratio=2.65x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.569, Ratio=2.67x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.599, Ratio=2.76x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.599, Ratio=2.69x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.557, Ratio=2.60x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.579, Ratio=2.66x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.572, Ratio=2.65x, Gap=-3.693
Batch 375/537: Loss=1.2128 (C:1.2128, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.569, Ratio=2.59x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.591, Ratio=2.68x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.599, Ratio=2.64x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.584, Ratio=2.63x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.577, Ratio=2.56x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.586, Ratio=2.66x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.583, Ratio=2.62x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.602, Ratio=2.71x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.578, Ratio=2.73x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.613, Ratio=2.79x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.585, Ratio=2.76x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.586, Ratio=2.65x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.551, Ratio=2.59x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.592, Ratio=2.72x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.546, Ratio=2.56x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.577, Ratio=2.63x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.583, Ratio=2.70x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.608, Ratio=2.80x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.594, Ratio=2.73x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.591, Ratio=2.63x, Gap=-3.534
