Starting Surface Distance Metric Analysis job...
Job ID: 180872
Node: gpuvm07
Time: Wed  9 Jul 09:20:30 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Wed Jul  9 09:20:35 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A30                     Off |   00000000:00:10.0 Off |                    0 |
| N/A   28C    P0             25W /  165W |       0MiB /  24576MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: NVIDIA A30
GPU memory: 25.3 GB
PyTorch setup verified!

Checking for required input data and models...

Starting SVM training...

Starting SVM Teacher Training Pipeline
==================================================
About to load data from: data/processed/snli_full_standard_SBERT.pt
Loading SNLI data from data/processed/snli_full_standard_SBERT.pt
Loaded 549367 samples
Data loaded successfully!
About to generate embeddings...
Generating lattice containment embedding space
Using device: cuda
Processing 549367 samples in batches of 1000
Processing batch 1/550
Processing batch 2/550
Processing batch 3/550
Processing batch 4/550
Processing batch 5/550
Processing batch 6/550
Processing batch 7/550
Processing batch 8/550
Processing batch 9/550
Processing batch 10/550
Processing batch 11/550
Processing batch 12/550
Processing batch 13/550
Processing batch 14/550
Processing batch 15/550
Processing batch 16/550
Processing batch 17/550
Processing batch 18/550
Processing batch 19/550
Processing batch 20/550
Processing batch 21/550
Processing batch 22/550
Processing batch 23/550
Processing batch 24/550
Processing batch 25/550
Processing batch 26/550
Processing batch 27/550
Processing batch 28/550
Processing batch 29/550
Processing batch 30/550
Processing batch 31/550
Processing batch 32/550
Processing batch 33/550
Processing batch 34/550
Processing batch 35/550
Processing batch 36/550
Processing batch 37/550
Processing batch 38/550
Processing batch 39/550
Processing batch 40/550
Processing batch 41/550
Processing batch 42/550
Processing batch 43/550
Processing batch 44/550
Processing batch 45/550
Processing batch 46/550
Processing batch 47/550
Processing batch 48/550
Processing batch 49/550
Processing batch 50/550
Processing batch 51/550
Processing batch 52/550
Processing batch 53/550
Processing batch 54/550
Processing batch 55/550
Processing batch 56/550
Processing batch 57/550
Processing batch 58/550
Processing batch 59/550
Processing batch 60/550
Processing batch 61/550
Processing batch 62/550
Processing batch 63/550
Processing batch 64/550
Processing batch 65/550
Processing batch 66/550
Processing batch 67/550
Processing batch 68/550
Processing batch 69/550
Processing batch 70/550
Processing batch 71/550
Processing batch 72/550
Processing batch 73/550
Processing batch 74/550
Processing batch 75/550
Processing batch 76/550
Processing batch 77/550
Processing batch 78/550
Processing batch 79/550
Processing batch 80/550
Processing batch 81/550
Processing batch 82/550
Processing batch 83/550
Processing batch 84/550
Processing batch 85/550
Processing batch 86/550
Processing batch 87/550
Processing batch 88/550
Processing batch 89/550
Processing batch 90/550
Processing batch 91/550
Processing batch 92/550
Processing batch 93/550
Processing batch 94/550
Processing batch 95/550
Processing batch 96/550
Processing batch 97/550
Processing batch 98/550
Processing batch 99/550
Processing batch 100/550
Processing batch 101/550
Processing batch 102/550
Processing batch 103/550
Processing batch 104/550
Processing batch 105/550
Processing batch 106/550
Processing batch 107/550
Processing batch 108/550
Processing batch 109/550
Processing batch 110/550
Processing batch 111/550
Processing batch 112/550
Processing batch 113/550
Processing batch 114/550
Processing batch 115/550
Processing batch 116/550
Processing batch 117/550
Processing batch 118/550
Processing batch 119/550
Processing batch 120/550
Processing batch 121/550
Processing batch 122/550
Processing batch 123/550
Processing batch 124/550
Processing batch 125/550
Processing batch 126/550
Processing batch 127/550
Processing batch 128/550
Processing batch 129/550
Processing batch 130/550
Processing batch 131/550
Processing batch 132/550
Processing batch 133/550
Processing batch 134/550
Processing batch 135/550
Processing batch 136/550
Processing batch 137/550
Processing batch 138/550
Processing batch 139/550
Processing batch 140/550
Processing batch 141/550
Processing batch 142/550
Processing batch 143/550
Processing batch 144/550
Processing batch 145/550
Processing batch 146/550
Processing batch 147/550
Processing batch 148/550
Processing batch 149/550
Processing batch 150/550
Processing batch 151/550
Processing batch 152/550
Processing batch 153/550
Processing batch 154/550
Processing batch 155/550
Processing batch 156/550
Processing batch 157/550
Processing batch 158/550
Processing batch 159/550
Processing batch 160/550
Processing batch 161/550
Processing batch 162/550
Processing batch 163/550
Processing batch 164/550
Processing batch 165/550
Processing batch 166/550
Processing batch 167/550
Processing batch 168/550
Processing batch 169/550
Processing batch 170/550
Processing batch 171/550
Processing batch 172/550
Processing batch 173/550
Processing batch 174/550
Processing batch 175/550
Processing batch 176/550
Processing batch 177/550
Processing batch 178/550
Processing batch 179/550
Processing batch 180/550
Processing batch 181/550
Processing batch 182/550
Processing batch 183/550
Processing batch 184/550
Processing batch 185/550
Processing batch 186/550
Processing batch 187/550
Processing batch 188/550
Processing batch 189/550
Processing batch 190/550
Processing batch 191/550
Processing batch 192/550
Processing batch 193/550
Processing batch 194/550
Processing batch 195/550
Processing batch 196/550
Processing batch 197/550
Processing batch 198/550
Processing batch 199/550
Processing batch 200/550
Processing batch 201/550
Processing batch 202/550
Processing batch 203/550
Processing batch 204/550
Processing batch 205/550
Processing batch 206/550
Processing batch 207/550
Processing batch 208/550
Processing batch 209/550
Processing batch 210/550
Processing batch 211/550
Processing batch 212/550
Processing batch 213/550
Processing batch 214/550
Processing batch 215/550
Processing batch 216/550
Processing batch 217/550
Processing batch 218/550
Processing batch 219/550
Processing batch 220/550
Processing batch 221/550
Processing batch 222/550
Processing batch 223/550
Processing batch 224/550
Processing batch 225/550
Processing batch 226/550
Processing batch 227/550
Processing batch 228/550
Processing batch 229/550
Processing batch 230/550
Processing batch 231/550
Processing batch 232/550
Processing batch 233/550
Processing batch 234/550
Processing batch 235/550
Processing batch 236/550
Processing batch 237/550
Processing batch 238/550
Processing batch 239/550
Processing batch 240/550
Processing batch 241/550
Processing batch 242/550
Processing batch 243/550
Processing batch 244/550
Processing batch 245/550
Processing batch 246/550
Processing batch 247/550
Processing batch 248/550
Processing batch 249/550
Processing batch 250/550
Processing batch 251/550
Processing batch 252/550
Processing batch 253/550
Processing batch 254/550
Processing batch 255/550
Processing batch 256/550
Processing batch 257/550
Processing batch 258/550
Processing batch 259/550
Processing batch 260/550
Processing batch 261/550
Processing batch 262/550
Processing batch 263/550
Processing batch 264/550
Processing batch 265/550
Processing batch 266/550
Processing batch 267/550
Processing batch 268/550
Processing batch 269/550
Processing batch 270/550
Processing batch 271/550
Processing batch 272/550
Processing batch 273/550
Processing batch 274/550
Processing batch 275/550
Processing batch 276/550
Processing batch 277/550
Processing batch 278/550
Processing batch 279/550
Processing batch 280/550
Processing batch 281/550
Processing batch 282/550
Processing batch 283/550
Processing batch 284/550
Processing batch 285/550
Processing batch 286/550
Processing batch 287/550
Processing batch 288/550
Processing batch 289/550
Processing batch 290/550
Processing batch 291/550
Processing batch 292/550
Processing batch 293/550
Processing batch 294/550
Processing batch 295/550
Processing batch 296/550
Processing batch 297/550
Processing batch 298/550
Processing batch 299/550
Processing batch 300/550
Processing batch 301/550
Processing batch 302/550
Processing batch 303/550
Processing batch 304/550
Processing batch 305/550
Processing batch 306/550
Processing batch 307/550
Processing batch 308/550
Processing batch 309/550
Processing batch 310/550
Processing batch 311/550
Processing batch 312/550
Processing batch 313/550
Processing batch 314/550
Processing batch 315/550
Processing batch 316/550
Processing batch 317/550
Processing batch 318/550
Processing batch 319/550
Processing batch 320/550
Processing batch 321/550
Processing batch 322/550
Processing batch 323/550
Processing batch 324/550
Processing batch 325/550
Processing batch 326/550
Processing batch 327/550
Processing batch 328/550
Processing batch 329/550
Processing batch 330/550
Processing batch 331/550
Processing batch 332/550
Processing batch 333/550
Processing batch 334/550
Processing batch 335/550
Processing batch 336/550
Processing batch 337/550
Processing batch 338/550
Processing batch 339/550
Processing batch 340/550
Processing batch 341/550
Processing batch 342/550
Processing batch 343/550
Processing batch 344/550
Processing batch 345/550
Processing batch 346/550
Processing batch 347/550
Processing batch 348/550
Processing batch 349/550
Processing batch 350/550
Processing batch 351/550
Processing batch 352/550
Processing batch 353/550
Processing batch 354/550
Processing batch 355/550
Processing batch 356/550
Processing batch 357/550
Processing batch 358/550
Processing batch 359/550
Processing batch 360/550
Processing batch 361/550
Processing batch 362/550
Processing batch 363/550
Processing batch 364/550
Processing batch 365/550
Processing batch 366/550
Processing batch 367/550
Processing batch 368/550
Processing batch 369/550
Processing batch 370/550
Processing batch 371/550
Processing batch 372/550
Processing batch 373/550
Processing batch 374/550
Processing batch 375/550
Processing batch 376/550
Processing batch 377/550
Processing batch 378/550
Processing batch 379/550
Processing batch 380/550
Processing batch 381/550
Processing batch 382/550
Processing batch 383/550
Processing batch 384/550
Processing batch 385/550
Processing batch 386/550
Processing batch 387/550
Processing batch 388/550
Processing batch 389/550
Processing batch 390/550
Processing batch 391/550
Processing batch 392/550
Processing batch 393/550
Processing batch 394/550
Processing batch 395/550
Processing batch 396/550
Processing batch 397/550
Processing batch 398/550
Processing batch 399/550
Processing batch 400/550
Processing batch 401/550
Processing batch 402/550
Processing batch 403/550
Processing batch 404/550
Processing batch 405/550
Processing batch 406/550
Processing batch 407/550
Processing batch 408/550
Processing batch 409/550
Processing batch 410/550
Processing batch 411/550
Processing batch 412/550
Processing batch 413/550
Processing batch 414/550
Processing batch 415/550
Processing batch 416/550
Processing batch 417/550
Processing batch 418/550
Processing batch 419/550
Processing batch 420/550
Processing batch 421/550
Processing batch 422/550
Processing batch 423/550
Processing batch 424/550
Processing batch 425/550
Processing batch 426/550
Processing batch 427/550
Processing batch 428/550
Processing batch 429/550
Processing batch 430/550
Processing batch 431/550
Processing batch 432/550
Processing batch 433/550
Processing batch 434/550
Processing batch 435/550
Processing batch 436/550
Processing batch 437/550
Processing batch 438/550
Processing batch 439/550
Processing batch 440/550
Processing batch 441/550
Processing batch 442/550
Processing batch 443/550
Processing batch 444/550
Processing batch 445/550
Processing batch 446/550
Processing batch 447/550
Processing batch 448/550
Processing batch 449/550
Processing batch 450/550
Processing batch 451/550
Processing batch 452/550
Processing batch 453/550
Processing batch 454/550
Processing batch 455/550
Processing batch 456/550
Processing batch 457/550
Processing batch 458/550
Processing batch 459/550
Processing batch 460/550
Processing batch 461/550
Processing batch 462/550
Processing batch 463/550
Processing batch 464/550
Processing batch 465/550
Processing batch 466/550
Processing batch 467/550
Processing batch 468/550
Processing batch 469/550
Processing batch 470/550
Processing batch 471/550
Processing batch 472/550
Processing batch 473/550
Processing batch 474/550
Processing batch 475/550
Processing batch 476/550
Processing batch 477/550
Processing batch 478/550
Processing batch 479/550
Processing batch 480/550
Processing batch 481/550
Processing batch 482/550
Processing batch 483/550
Processing batch 484/550
Processing batch 485/550
Processing batch 486/550
Processing batch 487/550
Processing batch 488/550
Processing batch 489/550
Processing batch 490/550
Processing batch 491/550
Processing batch 492/550
Processing batch 493/550
Processing batch 494/550
Processing batch 495/550
Processing batch 496/550
Processing batch 497/550
Processing batch 498/550
Processing batch 499/550
Processing batch 500/550
Processing batch 501/550
Processing batch 502/550
Processing batch 503/550
Processing batch 504/550
Processing batch 505/550
Processing batch 506/550
Processing batch 507/550
Processing batch 508/550
Processing batch 509/550
Processing batch 510/550
Processing batch 511/550
Processing batch 512/550
Processing batch 513/550
Processing batch 514/550
Processing batch 515/550
Processing batch 516/550
Processing batch 517/550
Processing batch 518/550
Processing batch 519/550
Processing batch 520/550
Processing batch 521/550
Processing batch 522/550
Processing batch 523/550
Processing batch 524/550
Processing batch 525/550
Processing batch 526/550
Processing batch 527/550
Processing batch 528/550
Processing batch 529/550
Processing batch 530/550
Processing batch 531/550
Processing batch 532/550
Processing batch 533/550
Processing batch 534/550
Processing batch 535/550
Processing batch 536/550
Processing batch 537/550
Processing batch 538/550
Processing batch 539/550
Processing batch 540/550
Processing batch 541/550
Processing batch 542/550
Processing batch 543/550
Processing batch 544/550
Processing batch 545/550
Processing batch 546/550
Processing batch 547/550
Processing batch 548/550
Processing batch 549/550
Processing batch 550/550
Preparing labels...
Analyzing lattice embeddings...

==================================================
LATTICE CONTAINMENT EMBEDDING ANALYSIS
==================================================
Embedding shape: (549367, 768)
Total samples: 549367

Entailment Class:
  Count: 183416
  Mean norm: 1.2180
  Std norm: 0.0892
  Mean per dimension: [0.01899897 0.03403895 0.01193759 0.02587069 0.02328306]...
  Std per dimension: [0.03066669 0.0450409  0.01954677 0.03404593 0.0320558 ]...

Neutral Class:
  Count: 182764
  Mean norm: 1.1616
  Std norm: 0.0826
  Mean per dimension: [0.01435648 0.0245106  0.00862564 0.02098269 0.01836825]...
  Std per dimension: [0.03267545 0.04597026 0.02015521 0.03497398 0.03309762]...

Contradiction Class:
  Count: 183187
  Mean norm: 1.0955
  Std norm: 0.0675
  Mean per dimension: [0.00797416 0.01797984 0.00441561 0.01234577 0.01001009]...
  Std per dimension: [0.0330552  0.04749043 0.02071265 0.03531532 0.03406962]...
Training SVM...
