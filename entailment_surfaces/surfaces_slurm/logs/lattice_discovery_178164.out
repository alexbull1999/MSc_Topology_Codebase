Starting Surface Distance Metric Analysis job...
Job ID: 178164
Node: gpuvm12
Time: Sat 28 Jun 19:39:10 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Sat Jun 28 19:39:12 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.120                Driver Version: 550.120        CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A30                     Off |   00000000:01:00.0 Off |                    0 |
| N/A   32C    P0             29W /  165W |       1MiB /  24576MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: NVIDIA A30
GPU memory: 25.2 GB
PyTorch setup verified!

Checking for required input data and models...
Found BERT data: data/processed/snli_full_standard_BERT.pt
✓ Found order model: models/enhanced_order_embeddings_snli_full.pt

Starting Lattice Metric Analysis...

Running Subsumption Metrics Analysis...
Surface Distance Metric Analyzer initialized
FOCUS: Testing distance metrics for premise-hypothesis pair relationships
Device: cuda
BERT data: data/processed/snli_full_standard_BERT.pt
Order model: models/enhanced_order_embeddings_snli_full.pt
Distance metrics: 10 total
Relational embedding spaces: 8 total
Each space represents premise-hypothesis pair relationships
Loading pre-processed data...
Loading BERT embeddings from data/processed/snli_full_standard_BERT.pt
BERT data loaded:
  Premise embeddings: torch.Size([549367, 768])
  Hypothesis embeddings: torch.Size([549367, 768])
  Labels: 549367
  Label distribution: {'contradiction': 183187, 'entailment': 183416, 'neutral': 182764}
Loading order model from models/enhanced_order_embeddings_snli_full.pt
Order model loaded (validation loss: 1.6769452275199535)
Loaded enhanced order model (val_loss: 1.6769)
Model asymmetry_weight: 0.3
Pipeline initialized: 50D → 30D hyperbolic
Running on: cuda
Enhanced model with asymmetry_weight: 0.3
Hyperbolic pipeline loaded successfully
Enhanced Hyperbolic Entailment Cones using device: cuda
Loaded enhanced order model (val_loss: 1.6769)
Model asymmetry_weight: 0.3
Pipeline initialized: 50D → 30D hyperbolic
Running on: cuda
Enhanced model with asymmetry_weight: 0.3
Successfully loaded enhanced hyperbolic projection of order embeddings
Enhanced cone pipeline loaded successfully
Class Lattice Analyzer initialized
Starting class-by-class subsumption metrics analysis
============================================================
  entailment: 1000 samples
  neutral: 1000 samples
  contradiction: 1000 samples
Computing order embeddings...
Testing 4 subsumption metrics on each entailment class...
Testing bert_embeddings...
  entailment: 1000 samples
  neutral: 1000 samples
  contradiction: 1000 samples
Testing order_embeddings...
  entailment: 1000 samples
  neutral: 1000 samples
  contradiction: 1000 samples
Results saved to lattice_subsumption_metrics_results_20250628_193953.json

Analysis complete! Results saved to lattice_subsumption_metrics_results_20250628_193953.json

Analysis completed with exit code: 0
Time: Sat 28 Jun 19:39:54 BST 2025

=== ANALYSIS SUCCESSFUL ===


Job finished.
